import{u as T,bH as D,a as $,r as c,j as e,e as j,B as o,bI as L,aF as M,d as m,A as b,ap as B,aq as F,N,ar as I,as as U,E as v,Q as A,a7 as w,U as y,D as z,bJ as E,aH as P,t as x}from"./main-oBfCarfk.js";import{L as Q}from"./link-BFS7U-KP.js";function u(t){if(t<60)return`${t} min`;if(t<1440){const a=Math.floor(t/60),l=t%60;return l>0?`${a}h ${l}m`:`${a} hour${a>1?"s":""}`}else if(t<10080){const a=Math.floor(t/1440),l=Math.floor(t%1440/60);return l>0?`${a}d ${l}h`:`${a} day${a>1?"s":""}`}else{const a=Math.floor(t/10080),l=Math.floor(t%10080/1440);return l>0?`${a}w ${l}d`:`${a} week${a>1?"s":""}`}}const R={easy:"bg-green-500/10 text-green-400 border-green-500/20",medium:"bg-amber-500/10 text-amber-400 border-amber-500/20",hard:"bg-red-500/10 text-red-400 border-red-500/20"};function q(){const t=T(),{id:a}=D({strict:!1}),{currentUser:l}=$(),[r,k]=c.useState(null),[S,h]=c.useState(!0),[p,g]=c.useState(!1);c.useEffect(()=>{async function s(){if(a){h(!0);try{const d=await E({data:{templateId:a}});d.success&&k(d.template)}catch(d){console.error("Failed to fetch store template:",d)}finally{h(!1)}}}s()},[a]);const C=async()=>{if(!(!l?.id||!r)){g(!0);try{const s=await P({data:{templateId:r.id,creatorId:l.id}});s.success?(x.success("Template added to your library!"),t({to:"/creator/library"})):x.error(s.error||"Failed to clone template")}catch(s){console.error("Clone store template error:",s),x.error("Failed to clone template")}finally{g(!1)}}};if(S)return e.jsxs("div",{className:"min-h-[calc(100vh-4rem)] bg-background flex flex-col items-center justify-center",children:[e.jsx(j,{className:"w-10 h-10 animate-spin text-violet-500 mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading template..."})]});if(!r)return e.jsx("div",{className:"container max-w-6xl mx-auto py-8 px-4",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground mb-2",children:"Template Not Found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"This template may have been unpublished or doesn't exist."}),e.jsx(o,{onClick:()=>t({to:"/creator/store"}),children:"Back to Store"})]})});const i=r.creatorId===l?.id,f=r.sessions.reduce((s,d)=>s+(d.durationMinutes||0),0);return e.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-background",children:e.jsxs("div",{className:"container max-w-5xl mx-auto py-8 px-4",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs(o,{variant:"ghost",onClick:()=>t({to:"/creator/store"}),className:"mb-4 text-muted-foreground hover:text-foreground",children:[e.jsx(L,{className:"w-4 h-4 mr-2"}),"Back to Store"]}),e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(M,{className:"w-8 h-8 text-violet-500 shrink-0"}),e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:r.title}),e.jsx(m,{variant:"outline",className:"text-xs uppercase font-bold shrink-0 bg-violet-500/10 text-violet-500 border-violet-500/30",children:"Shared Template"}),i&&e.jsx(m,{variant:"outline",className:"text-xs uppercase font-bold shrink-0 bg-cyan-500/10 text-cyan-500 border-cyan-500/30",children:"Yours"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mt-1 ml-11",children:[e.jsx(b,{className:"w-4 h-4"}),e.jsxs("span",{children:["by ",r.creatorName,i?" (you)":""]})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-card border border-border rounded-lg p-5",children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wider mb-3",children:"Description"}),e.jsx("p",{className:"text-foreground whitespace-pre-wrap",children:r.description||e.jsx("span",{className:"text-muted-foreground italic",children:"No description"})})]}),e.jsxs("div",{className:"bg-card border border-border rounded-lg p-5",children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wider mb-3",children:"Driving Question"}),e.jsx("p",{className:"text-foreground",children:r.drivingQuestion||e.jsx("span",{className:"text-muted-foreground italic",children:"No driving question"})})]}),r.background&&e.jsxs("div",{className:"bg-card border border-border rounded-lg p-5",children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wider mb-3",children:"Background"}),e.jsx("p",{className:"text-foreground whitespace-pre-wrap",children:r.background})]}),e.jsxs("div",{className:"bg-card border border-border rounded-lg p-5",children:[e.jsxs("h3",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wider mb-4",children:["Sessions (",r.sessions.length,")"]}),r.sessions.length===0?e.jsx("p",{className:"text-muted-foreground text-sm",children:"No sessions configured."}):e.jsx("div",{className:"space-y-3",children:r.sessions.map((s,d)=>e.jsx(B,{children:e.jsxs("div",{className:"rounded-lg bg-muted/30 border border-border",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-violet-500/10 border border-violet-500/30 flex items-center justify-center shrink-0",children:e.jsx("span",{className:"text-xs font-bold text-violet-400",children:d+1})}),e.jsxs(F,{className:"flex-1 min-w-0 flex items-center gap-2 cursor-pointer [&[data-state=open]_.chevron-icon]:rotate-180",children:[e.jsx("span",{className:"font-medium text-foreground text-sm truncate",children:s.title?.replace(/^Session\s+\d+:\s*/,"")||"Untitled"}),e.jsx(m,{variant:"outline",className:`text-[10px] shrink-0 ${R[s.difficulty]||""}`,children:s.difficulty}),s.deliverableType!=="none"&&e.jsx(N,{className:"w-3 h-3 text-muted-foreground shrink-0"}),e.jsx("span",{className:"text-[10px] text-muted-foreground shrink-0 ml-auto mr-1",children:s.durationMinutes>0?u(s.durationMinutes):"-"}),e.jsx(I,{className:"chevron-icon w-4 h-4 text-muted-foreground shrink-0 transition-transform duration-200"})]})]}),e.jsx(U,{children:e.jsxs("div",{className:"px-3 pb-3 pt-0 pl-14 space-y-2",children:[s.topic&&e.jsx("p",{className:"text-xs text-muted-foreground",children:s.topic}),s.guide&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Guide:"}),e.jsx("p",{className:"text-xs text-foreground mt-0.5 whitespace-pre-wrap",children:s.guide})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-muted-foreground",children:[e.jsx(v,{className:"w-3 h-3 shrink-0"}),e.jsx("span",{children:s.durationMinutes>0?u(s.durationMinutes):"-"})]}),s.deliverableType!=="none"&&e.jsxs("div",{className:"flex items-center gap-3 text-xs text-muted-foreground",children:[e.jsx(N,{className:"w-3 h-3 shrink-0"}),e.jsxs("span",{children:["Deliverable: ",s.deliverableTitle||"Document",s.deliverableDescription&&` - ${s.deliverableDescription}`]})]}),s.resources&&s.resources.length>0&&e.jsxs("div",{className:"mt-1",children:[e.jsxs("span",{className:"text-xs font-medium text-muted-foreground flex items-center gap-1 mb-1",children:[e.jsx(Q,{className:"w-3 h-3"}),"Resources (",s.resources.length,")"]}),e.jsx("div",{className:"space-y-1 pl-4",children:s.resources.map(n=>e.jsxs("div",{className:"text-xs text-muted-foreground flex items-center gap-1.5",children:[e.jsx("span",{className:"text-foreground",children:n.title}),e.jsx(m,{variant:"outline",className:"text-[9px] px-1 py-0 h-4",children:n.type})]},n.id))})]}),s.rubrics&&s.rubrics.length>0&&e.jsxs("div",{className:"mt-1",children:[e.jsxs("span",{className:"text-xs font-medium text-muted-foreground flex items-center gap-1 mb-1",children:[e.jsx(A,{className:"w-3 h-3"}),"Rubric (",s.rubrics.length," criteria)"]}),e.jsx("div",{className:"space-y-1 pl-4",children:s.rubrics.map(n=>e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"text-foreground font-medium",children:n.criteria}),n.description&&e.jsxs("span",{className:"text-muted-foreground",children:[" - ",n.description]}),e.jsxs("span",{className:"text-muted-foreground ml-1",children:["(weight: ",n.weight,")"]})]},n.id))})]})]})})]})},s.id))})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-card border border-border rounded-lg p-5",children:i?e.jsxs(o,{variant:"outline",className:"w-full",onClick:()=>t({to:"/creator/library"}),children:[e.jsx(w,{className:"w-4 h-4 mr-2"}),"View in Library"]}):e.jsx(o,{className:"w-full bg-violet-600 hover:bg-violet-700 text-white",onClick:C,disabled:p,children:p?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"w-4 h-4 mr-2 animate-spin"}),"Cloning..."]}):e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"w-4 h-4 mr-2"}),"Add to Library"]})})}),e.jsxs("div",{className:"bg-card border border-border rounded-lg p-5",children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wider mb-3",children:"Details"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-2 text-muted-foreground",children:[r.teamSize===1?e.jsx(b,{className:"w-4 h-4"}):e.jsx(y,{className:"w-4 h-4"}),"Type"]}),e.jsx("span",{className:"text-foreground",children:r.teamSize===1?"Individual":"Group"})]}),r.teamSize>1&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(y,{className:"w-4 h-4"}),"Team Size"]}),e.jsxs("span",{className:"text-foreground",children:[r.teamSize," members"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(z,{className:"w-4 h-4"}),"Sessions"]}),e.jsx("span",{className:"text-foreground",children:r.sessionCount})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-2 text-muted-foreground shrink-0",children:[e.jsx(v,{className:"w-4 h-4"}),"Total Duration"]}),e.jsx("span",{className:"text-foreground",children:f>0?u(f):"-"})]})]})]}),e.jsxs("div",{className:"bg-card border border-border rounded-lg p-5",children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wider mb-3",children:"Published By"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-full bg-violet-500/10 border border-violet-500/30 flex items-center justify-center shrink-0",children:e.jsx("span",{className:"text-violet-400 font-medium text-sm",children:r.creatorName?.charAt(0).toUpperCase()})}),e.jsx("div",{children:e.jsxs("p",{className:"text-sm font-medium text-foreground",children:[r.creatorName,i?" (you)":""]})})]})]}),e.jsxs("div",{className:"bg-card border border-border rounded-lg p-5",children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground uppercase tracking-wider mb-3",children:"Created"}),e.jsx("p",{className:"text-sm text-foreground",children:new Date(r.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]})]})]})})}function O(){return e.jsx(q,{})}export{O as component};
