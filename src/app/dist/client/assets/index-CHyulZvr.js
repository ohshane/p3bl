import{u as j,a as p,r as c,j as e,I as g,B as k,e as C,b as w,f as L,g as b,h as F}from"./main-oBfCarfk.js";import{L as f}from"./label-D--meCET.js";import{A,a as R}from"./alert-C8I4vCtu.js";import{C as U}from"./circle-alert-CGSAmO4T.js";import{E as B}from"./eye-off-BCX6L8Ou.js";import{E as D}from"./eye-BcuVz-Uk.js";function q({redirectTo:t}){const n=j(),{login:i,isLoading:r,error:l,clearError:a}=p(),[m,v]=c.useState(""),[u,N]=c.useState(""),[x,y]=c.useState(!1),[o,h]=c.useState({}),S=()=>{const s={};return m.trim()||(s.email="Email or username is required"),u||(s.password="Password is required"),h(s),Object.keys(s).length===0},E=async s=>{if(s.preventDefault(),a(),!S())return;if((await i(m.trim(),u)).success){L();const P=p.getState().currentUser;n(t?{to:t}:{to:b(P?.role??[])})}};return e.jsxs("form",{onSubmit:E,className:"space-y-6",children:[l&&e.jsxs(A,{variant:"destructive",children:[e.jsx(U,{className:"h-4 w-4"}),e.jsx(R,{children:l})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"email",children:"Email or Username"}),e.jsx(g,{id:"email",type:"text",placeholder:"you@example.com",value:m,onChange:s=>{v(s.target.value),o.email&&h(d=>({...d,email:void 0}))},className:"bg-background border-border placeholder:text-muted-foreground",autoComplete:"email",autoFocus:!0}),o.email&&e.jsx("p",{className:"text-sm text-destructive",children:o.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(f,{htmlFor:"password",children:"Password"}),e.jsx("span",{className:"text-sm text-cyan-600 hover:text-cyan-700 transition-colors cursor-pointer",children:"Forgot password?"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(g,{id:"password",type:x?"text":"password",placeholder:"Enter your password",value:u,onChange:s=>{N(s.target.value),o.password&&h(d=>({...d,password:void 0}))},className:"bg-background border-border placeholder:text-muted-foreground pr-10",autoComplete:"current-password"}),e.jsx("button",{type:"button",onClick:()=>y(!x),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:x?e.jsx(B,{className:"h-4 w-4"}):e.jsx(D,{className:"h-4 w-4"})})]}),o.password&&e.jsx("p",{className:"text-sm text-destructive",children:o.password})]}),e.jsx(k,{type:"submit",className:"w-full bg-cyan-600 hover:bg-cyan-700",disabled:r,children:r?e.jsxs(e.Fragment,{children:[e.jsx(C,{className:"mr-2 h-4 w-4 animate-spin"}),"Signing in..."]}):"Sign in"}),e.jsxs("p",{className:"text-center text-sm text-muted-foreground",children:["Don't have an account?"," ",e.jsx(w,{to:"/signup",className:"text-cyan-600 hover:text-cyan-700 transition-colors",children:"Sign up"})]})]})}function z(){const t=j(),{isAuthenticated:n,currentUser:i}=p(),r=typeof window<"u"?new URLSearchParams(window.location.search).get("redirect_uri"):null,l=F(),a=r&&r.startsWith("/")?r:l??void 0;return c.useEffect(()=>{if(n&&i){if(a){t({to:a});return}t({to:b(i.role)})}},[n,i,t,a]),e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center px-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx(w,{to:"/",className:"inline-block",children:e.jsx("img",{src:"/android-chrome-192x192.png",alt:"Peabee",className:"w-16 h-16 rounded-2xl shadow-lg shadow-cyan-500/25 mx-auto mb-4"})}),e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Welcome back"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Sign in to your account"})]}),e.jsx("div",{className:"bg-card border border-border shadow-sm rounded-xl p-6",children:e.jsx(q,{redirectTo:a})}),e.jsx("p",{className:"text-center text-xs text-muted-foreground mt-8",children:"Peabee"})]})})}export{z as component};
