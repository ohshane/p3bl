const s=Symbol.for("drizzle:entityKind");function g(r,e){if(!r||typeof r!="object")return!1;if(r instanceof e)return!0;if(!Object.prototype.hasOwnProperty.call(e,s))throw new Error(`Class "${e.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let t=Object.getPrototypeOf(r).constructor;if(t)for(;t;){if(s in t&&t[s]===e[s])return!0;t=Object.getPrototypeOf(t)}return!1}class z{constructor(e,t){this.table=e,this.config=t,this.name=t.name,this.keyAsName=t.keyAsName,this.notNull=t.notNull,this.default=t.default,this.defaultFn=t.defaultFn,this.onUpdateFn=t.onUpdateFn,this.hasDefault=t.hasDefault,this.primary=t.primaryKey,this.isUnique=t.isUnique,this.uniqueName=t.uniqueName,this.uniqueType=t.uniqueType,this.dataType=t.dataType,this.columnType=t.columnType,this.generated=t.generated,this.generatedIdentity=t.generatedIdentity}static[s]="Column";name;keyAsName;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;generated=void 0;generatedIdentity=void 0;config;mapFromDriverValue(e){return e}mapToDriverValue(e){return e}shouldDisableInsert(){return this.config.generated!==void 0&&this.config.generated.type!=="byDefault"}}class W{static[s]="ColumnBuilder";config;constructor(e,t,i){this.config={name:e,keyAsName:e==="",notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:t,columnType:i,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(e){return this.config.default=e,this.config.hasDefault=!0,this}$defaultFn(e){return this.config.defaultFn=e,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(e){return this.config.onUpdateFn=e,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(e){this.config.name===""&&(this.config.name=e)}}const L=Symbol.for("drizzle:Name"),v=Symbol.for("drizzle:isPgEnum");function G(r){return!!r&&typeof r=="function"&&v in r&&r[v]===!0}class E{static[s]="Subquery";constructor(e,t,i,u=!1,o=[]){this._={brand:"Subquery",sql:e,selectedFields:t,alias:i,isWith:u,usedTables:o}}}const Y={startActiveSpan(r,e){return e()}},B=Symbol.for("drizzle:ViewBaseConfig"),T=Symbol.for("drizzle:Schema"),V=Symbol.for("drizzle:Columns"),O=Symbol.for("drizzle:ExtraConfigColumns"),x=Symbol.for("drizzle:OriginalName"),D=Symbol.for("drizzle:BaseName"),w=Symbol.for("drizzle:IsAlias"),U=Symbol.for("drizzle:ExtraConfigBuilder"),H=Symbol.for("drizzle:IsDrizzleTable");class c{static[s]="Table";static Symbol={Name:L,Schema:T,OriginalName:x,Columns:V,ExtraConfigColumns:O,BaseName:D,IsAlias:w,ExtraConfigBuilder:U};[L];[x];[T];[V];[O];[D];[w]=!1;[H]=!0;[U]=void 0;constructor(e,t,i){this[L]=this[x]=e,this[T]=t,this[D]=i}}function X(r){return r!=null&&typeof r.getSQL=="function"}function Z(r){const e={sql:"",params:[]};for(const t of r)e.sql+=t.sql,e.params.push(...t.params),t.typings?.length&&(e.typings||(e.typings=[]),e.typings.push(...t.typings));return e}class y{static[s]="StringChunk";value;constructor(e){this.value=Array.isArray(e)?e:[e]}getSQL(){return new m([this])}}class m{constructor(e){this.queryChunks=e;for(const t of e)if(g(t,c)){const i=t[c.Symbol.Schema];this.usedTables.push(i===void 0?t[c.Symbol.Name]:i+"."+t[c.Symbol.Name])}}static[s]="SQL";decoder=K;shouldInlineParams=!1;usedTables=[];append(e){return this.queryChunks.push(...e.queryChunks),this}toQuery(e){return Y.startActiveSpan("drizzle.buildSQL",t=>{const i=this.buildQueryFromSourceParams(this.queryChunks,e);return t?.setAttributes({"drizzle.query.text":i.sql,"drizzle.query.params":JSON.stringify(i.params)}),i})}buildQueryFromSourceParams(e,t){const i=Object.assign({},t,{inlineParams:t.inlineParams||this.shouldInlineParams,paramStartIndex:t.paramStartIndex||{value:0}}),{casing:u,escapeName:o,escapeParam:p,prepareTyping:d,inlineParams:l,paramStartIndex:S}=i;return Z(e.map(n=>{if(g(n,y))return{sql:n.value.join(""),params:[]};if(g(n,C))return{sql:o(n.value),params:[]};if(n===void 0)return{sql:"",params:[]};if(Array.isArray(n)){const a=[new y("(")];for(const[f,M]of n.entries())a.push(M),f<n.length-1&&a.push(new y(", "));return a.push(new y(")")),this.buildQueryFromSourceParams(a,i)}if(g(n,m))return this.buildQueryFromSourceParams(n.queryChunks,{...i,inlineParams:l||n.shouldInlineParams});if(g(n,c)){const a=n[c.Symbol.Schema],f=n[c.Symbol.Name];return{sql:a===void 0||n[w]?o(f):o(a)+"."+o(f),params:[]}}if(g(n,z)){const a=u.getColumnCasing(n);if(t.invokeSource==="indexes")return{sql:o(a),params:[]};const f=n.table[c.Symbol.Schema];return{sql:n.table[w]||f===void 0?o(n.table[c.Symbol.Name])+"."+o(a):o(f)+"."+o(n.table[c.Symbol.Name])+"."+o(a),params:[]}}if(g(n,ee)){const a=n[B].schema,f=n[B].name;return{sql:a===void 0||n[B].isAlias?o(f):o(a)+"."+o(f),params:[]}}if(g(n,J)){if(g(n.value,q))return{sql:p(S.value++,n),params:[n],typings:["none"]};const a=n.value===null?null:n.encoder.mapToDriverValue(n.value);if(g(a,m))return this.buildQueryFromSourceParams([a],i);if(l)return{sql:this.mapInlineParam(a,i),params:[]};let f=["none"];return d&&(f=[d(n.encoder)]),{sql:p(S.value++,a),params:[a],typings:f}}return g(n,q)?{sql:p(S.value++,n),params:[n],typings:["none"]}:g(n,m.Aliased)&&n.fieldAlias!==void 0?{sql:o(n.fieldAlias),params:[]}:g(n,E)?n._.isWith?{sql:o(n._.alias),params:[]}:this.buildQueryFromSourceParams([new y("("),n._.sql,new y(") "),new C(n._.alias)],i):G(n)?n.schema?{sql:o(n.schema)+"."+o(n.enumName),params:[]}:{sql:o(n.enumName),params:[]}:X(n)?n.shouldOmitSQLParens?.()?this.buildQueryFromSourceParams([n.getSQL()],i):this.buildQueryFromSourceParams([new y("("),n.getSQL(),new y(")")],i):l?{sql:this.mapInlineParam(n,i),params:[]}:{sql:p(S.value++,n),params:[n],typings:["none"]}}))}mapInlineParam(e,{escapeString:t}){if(e===null)return"null";if(typeof e=="number"||typeof e=="boolean")return e.toString();if(typeof e=="string")return t(e);if(typeof e=="object"){const i=e.toString();return t(i==="[object Object]"?JSON.stringify(e):i)}throw new Error("Unexpected param value: "+e)}getSQL(){return this}as(e){return e===void 0?this:new m.Aliased(this,e)}mapWith(e){return this.decoder=typeof e=="function"?{mapFromDriverValue:e}:e,this}inlineParams(){return this.shouldInlineParams=!0,this}if(e){return e?this:void 0}}class C{constructor(e){this.value=e}static[s]="Name";brand;getSQL(){return new m([this])}}const K={mapFromDriverValue:r=>r},j={mapToDriverValue:r=>r};({...K,...j});class J{constructor(e,t=j){this.value=e,this.encoder=t}static[s]="Param";brand;getSQL(){return new m([this])}}function I(r,...e){const t=[];(e.length>0||r.length>0&&r[0]!=="")&&t.push(new y(r[0]));for(const[i,u]of e.entries())t.push(u,new y(r[i+1]));return new m(t)}(r=>{function e(){return new m([])}r.empty=e;function t(l){return new m(l)}r.fromList=t;function i(l){return new m([new y(l)])}r.raw=i;function u(l,S){const n=[];for(const[a,f]of l.entries())a>0&&S!==void 0&&n.push(S),n.push(f);return new m(n)}r.join=u;function o(l){return new C(l)}r.identifier=o;function p(l){return new q(l)}r.placeholder=p;function d(l,S){return new J(l,S)}r.param=d})(I||(I={}));(r=>{class e{constructor(i,u){this.sql=i,this.fieldAlias=u}static[s]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new e(this.sql,this.fieldAlias)}}r.Aliased=e})(m||(m={}));class q{constructor(e){this.name=e}static[s]="Placeholder";getSQL(){return new m([this])}}const k=Symbol.for("drizzle:IsDrizzleView");class ee{static[s]="View";[B];[k]=!0;constructor({name:e,schema:t,selectedFields:i,query:u}){this[B]={name:e,originalName:e,schema:t,selectedFields:i,query:u,isExisting:!u,isAlias:!1}}getSQL(){return new m([this])}}z.prototype.getSQL=function(){return new m([this])};c.prototype.getSQL=function(){return new m([this])};E.prototype.getSQL=function(){return new m([this])};function N(r,e){return{name:typeof r=="string"&&r.length>0?r:"",config:typeof r=="object"?r:e}}const $=typeof TextDecoder>"u"?null:new TextDecoder;class te{static[s]="SQLiteForeignKeyBuilder";reference;_onUpdate;_onDelete;constructor(e,t){this.reference=()=>{const{name:i,columns:u,foreignColumns:o}=e();return{name:i,columns:u,foreignTable:o[0].table,foreignColumns:o}},t&&(this._onUpdate=t.onUpdate,this._onDelete=t.onDelete)}onUpdate(e){return this._onUpdate=e,this}onDelete(e){return this._onDelete=e,this}build(e){return new re(e,this)}}class re{constructor(e,t){this.table=e,this.reference=t.reference,this.onUpdate=t._onUpdate,this.onDelete=t._onDelete}static[s]="SQLiteForeignKey";reference;onUpdate;onDelete;getName(){const{name:e,columns:t,foreignColumns:i}=this.reference(),u=t.map(d=>d.name),o=i.map(d=>d.name),p=[this.table[L],...u,i[0].table[L],...o];return e??`${p.join("_")}_fk`}}function ie(r,e){return`${r[L]}_${e.join("_")}_unique`}class h extends W{static[s]="SQLiteColumnBuilder";foreignKeyConfigs=[];references(e,t={}){return this.foreignKeyConfigs.push({ref:e,actions:t}),this}unique(e){return this.config.isUnique=!0,this.config.uniqueName=e,this}generatedAlwaysAs(e,t){return this.config.generated={as:e,type:"always",mode:t?.mode??"virtual"},this}buildForeignKeys(e,t){return this.foreignKeyConfigs.map(({ref:i,actions:u})=>((o,p)=>{const d=new te(()=>{const l=o();return{columns:[e],foreignColumns:[l]}});return p.onUpdate&&d.onUpdate(p.onUpdate),p.onDelete&&d.onDelete(p.onDelete),d.build(t)})(i,u))}}class b extends z{constructor(e,t){t.uniqueName||(t.uniqueName=ie(e,[t.name])),super(e,t),this.table=e}static[s]="SQLiteColumn"}class ne extends h{static[s]="SQLiteBigIntBuilder";constructor(e){super(e,"bigint","SQLiteBigInt")}build(e){return new se(e,this.config)}}class se extends b{static[s]="SQLiteBigInt";getSQLType(){return"blob"}mapFromDriverValue(e){if(typeof Buffer<"u"&&Buffer.from){const t=Buffer.isBuffer(e)?e:e instanceof ArrayBuffer?Buffer.from(e):e.buffer?Buffer.from(e.buffer,e.byteOffset,e.byteLength):Buffer.from(e);return BigInt(t.toString("utf8"))}return BigInt($.decode(e))}mapToDriverValue(e){return Buffer.from(e.toString())}}class oe extends h{static[s]="SQLiteBlobJsonBuilder";constructor(e){super(e,"json","SQLiteBlobJson")}build(e){return new ae(e,this.config)}}class ae extends b{static[s]="SQLiteBlobJson";getSQLType(){return"blob"}mapFromDriverValue(e){if(typeof Buffer<"u"&&Buffer.from){const t=Buffer.isBuffer(e)?e:e instanceof ArrayBuffer?Buffer.from(e):e.buffer?Buffer.from(e.buffer,e.byteOffset,e.byteLength):Buffer.from(e);return JSON.parse(t.toString("utf8"))}return JSON.parse($.decode(e))}mapToDriverValue(e){return Buffer.from(JSON.stringify(e))}}class ue extends h{static[s]="SQLiteBlobBufferBuilder";constructor(e){super(e,"buffer","SQLiteBlobBuffer")}build(e){return new le(e,this.config)}}class le extends b{static[s]="SQLiteBlobBuffer";mapFromDriverValue(e){return Buffer.isBuffer(e)?e:Buffer.from(e)}getSQLType(){return"blob"}}function me(r,e){const{name:t,config:i}=N(r,e);return i?.mode==="json"?new oe(t):i?.mode==="bigint"?new ne(t):new ue(t)}class fe extends h{static[s]="SQLiteCustomColumnBuilder";constructor(e,t,i){super(e,"custom","SQLiteCustomColumn"),this.config.fieldConfig=t,this.config.customTypeParams=i}build(e){return new ce(e,this.config)}}class ce extends b{static[s]="SQLiteCustomColumn";sqlName;mapTo;mapFrom;constructor(e,t){super(e,t),this.sqlName=t.customTypeParams.dataType(t.fieldConfig),this.mapTo=t.customTypeParams.toDriver,this.mapFrom=t.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(e){return typeof this.mapFrom=="function"?this.mapFrom(e):e}mapToDriverValue(e){return typeof this.mapTo=="function"?this.mapTo(e):e}}function de(r){return(e,t)=>{const{name:i,config:u}=N(e,t);return new fe(i,u,r)}}class A extends h{static[s]="SQLiteBaseIntegerBuilder";constructor(e,t,i){super(e,t,i),this.config.autoIncrement=!1}primaryKey(e){return e?.autoIncrement&&(this.config.autoIncrement=!0),this.config.hasDefault=!0,super.primaryKey()}}class P extends b{static[s]="SQLiteBaseInteger";autoIncrement=this.config.autoIncrement;getSQLType(){return"integer"}}class pe extends A{static[s]="SQLiteIntegerBuilder";constructor(e){super(e,"number","SQLiteInteger")}build(e){return new ge(e,this.config)}}class ge extends P{static[s]="SQLiteInteger"}class Se extends A{static[s]="SQLiteTimestampBuilder";constructor(e,t){super(e,"date","SQLiteTimestamp"),this.config.mode=t}defaultNow(){return this.default(I`(cast((julianday('now') - 2440587.5)*86400000 as integer))`)}build(e){return new ye(e,this.config)}}class ye extends P{static[s]="SQLiteTimestamp";mode=this.config.mode;mapFromDriverValue(e){return this.config.mode==="timestamp"?new Date(e*1e3):new Date(e)}mapToDriverValue(e){const t=e.getTime();return this.config.mode==="timestamp"?Math.floor(t/1e3):t}}class he extends A{static[s]="SQLiteBooleanBuilder";constructor(e,t){super(e,"boolean","SQLiteBoolean"),this.config.mode=t}build(e){return new be(e,this.config)}}class be extends P{static[s]="SQLiteBoolean";mode=this.config.mode;mapFromDriverValue(e){return Number(e)===1}mapToDriverValue(e){return e?1:0}}function R(r,e){const{name:t,config:i}=N(r,e);return i?.mode==="timestamp"||i?.mode==="timestamp_ms"?new Se(t,i.mode):i?.mode==="boolean"?new he(t,i.mode):new pe(t)}class Qe extends h{static[s]="SQLiteNumericBuilder";constructor(e){super(e,"string","SQLiteNumeric")}build(e){return new Le(e,this.config)}}class Le extends b{static[s]="SQLiteNumeric";mapFromDriverValue(e){return typeof e=="string"?e:String(e)}getSQLType(){return"numeric"}}class Be extends h{static[s]="SQLiteNumericNumberBuilder";constructor(e){super(e,"number","SQLiteNumericNumber")}build(e){return new Ne(e,this.config)}}class Ne extends b{static[s]="SQLiteNumericNumber";mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}mapToDriverValue=String;getSQLType(){return"numeric"}}class we extends h{static[s]="SQLiteNumericBigIntBuilder";constructor(e){super(e,"bigint","SQLiteNumericBigInt")}build(e){return new Te(e,this.config)}}class Te extends b{static[s]="SQLiteNumericBigInt";mapFromDriverValue=BigInt;mapToDriverValue=String;getSQLType(){return"numeric"}}function xe(r,e){const{name:t,config:i}=N(r,e),u=i?.mode;return u==="number"?new Be(t):u==="bigint"?new we(t):new Qe(t)}class De extends h{static[s]="SQLiteRealBuilder";constructor(e){super(e,"number","SQLiteReal")}build(e){return new Ce(e,this.config)}}class Ce extends b{static[s]="SQLiteReal";getSQLType(){return"real"}}function Ie(r){return new De(r??"")}class qe extends h{static[s]="SQLiteTextBuilder";constructor(e,t){super(e,"string","SQLiteText"),this.config.enumValues=t.enum,this.config.length=t.length}build(e){return new Fe(e,this.config)}}class Fe extends b{static[s]="SQLiteText";enumValues=this.config.enumValues;length=this.config.length;constructor(e,t){super(e,t)}getSQLType(){return`text${this.config.length?`(${this.config.length})`:""}`}}class ze extends h{static[s]="SQLiteTextJsonBuilder";constructor(e){super(e,"json","SQLiteTextJson")}build(e){return new Ae(e,this.config)}}class Ae extends b{static[s]="SQLiteTextJson";getSQLType(){return"text"}mapFromDriverValue(e){return JSON.parse(e)}mapToDriverValue(e){return JSON.stringify(e)}}function Q(r,e={}){const{name:t,config:i}=N(r,e);return i.mode==="json"?new ze(t):new qe(t,i)}function Pe(){return{blob:me,customType:de,integer:R,numeric:xe,real:Ie,text:Q}}const F=Symbol.for("drizzle:SQLiteInlineForeignKeys");class ve extends c{static[s]="SQLiteTable";static Symbol=Object.assign({},c.Symbol,{InlineForeignKeys:F});[c.Symbol.Columns];[F]=[];[c.Symbol.ExtraConfigBuilder]=void 0}function Ve(r,e,t,i,u=r){const o=new ve(r,i,u),p=typeof e=="function"?e(Pe()):e,d=Object.fromEntries(Object.entries(p).map(([S,n])=>{const a=n;a.setName(S);const f=a.build(o);return o[F].push(...a.buildForeignKeys(f,o)),[S,f]})),l=Object.assign(o,d);return l[c.Symbol.Columns]=d,l[c.Symbol.ExtraConfigColumns]=d,l}const Oe=(r,e,t)=>Ve(r,e);Oe("system_settings",{id:Q("id").primaryKey(),key:Q("key").notNull().unique(),value:Q("value").notNull(),description:Q("description"),updatedAt:R("updated_at",{mode:"timestamp"}).notNull().$defaultFn(()=>new Date),updatedBy:Q("updated_by")});const _={AI_MODEL:"ai_model",AI_API_BASE:"ai_api_base"},Ue={[_.AI_MODEL]:"openrouter/auto",[_.AI_API_BASE]:"https://openrouter.ai/api/v1"};export{Ue as D,_ as S};
