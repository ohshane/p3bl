import{u as y,a as v,r,j as e,I as x,C as L,X as B,B as D,e as O,b as P,f as $,g as C,h as z}from"./main-oBfCarfk.js";import{L as h}from"./label-D--meCET.js";import{A as I,a as T}from"./alert-C8I4vCtu.js";import{C as Z}from"./circle-alert-CGSAmO4T.js";import{E as _}from"./eye-off-BCX6L8Ou.js";import{E as H}from"./eye-BcuVz-Uk.js";function J({redirectTo:d}){const p=y(),{register:m,isLoading:n,error:f,clearError:i}=v(),[g,S]=r.useState(""),[u,E]=r.useState(""),[w,k]=r.useState(""),[o,R]=r.useState(""),[b,A]=r.useState(""),[j,F]=r.useState(!1),[t,l]=r.useState({}),N=[{label:"At least 8 characters",test:s=>s.length>=8},{label:"Contains lowercase letter",test:s=>/[a-z]/.test(s)},{label:"Contains uppercase letter",test:s=>/[A-Z]/.test(s)},{label:"Contains a number",test:s=>/\d/.test(s)}],q=()=>{const s={};return g.trim()?g.trim().length<2&&(s.name="Name must be at least 2 characters"):s.name="Name is required",u.trim()?u.trim().length<3?s.username="Username must be at least 3 characters":/^[a-zA-Z0-9_-]+$/.test(u.trim())||(s.username="Only letters, numbers, underscores, and hyphens"):s.username="Username is required",w.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(w)||(s.email="Please enter a valid email address"):s.email="Email is required",o?N.filter(c=>!c.test(o)).length>0&&(s.password="Password does not meet requirements"):s.password="Password is required",b?o!==b&&(s.confirmPassword="Passwords do not match"):s.confirmPassword="Please confirm your password",l(s),Object.keys(s).length===0},U=async s=>{if(s.preventDefault(),i(),!q())return;if((await m({name:g.trim(),username:u.trim(),email:w.trim(),password:o})).success){$();const c=v.getState().currentUser;p({to:d||C(c?.role??[])})}};return e.jsxs("form",{onSubmit:U,className:"space-y-5",children:[f&&e.jsxs(I,{variant:"destructive",children:[e.jsx(Z,{className:"h-4 w-4"}),e.jsx(T,{children:f})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"name",children:"Full Name"}),e.jsx(x,{id:"name",type:"text",placeholder:"John Doe",value:g,onChange:s=>{S(s.target.value),t.name&&l(a=>({...a,name:void 0}))},className:"bg-background border-border placeholder:text-muted-foreground",autoComplete:"name",autoFocus:!0}),t.name&&e.jsx("p",{className:"text-sm text-destructive",children:t.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"username",children:"Username"}),e.jsx(x,{id:"username",type:"text",placeholder:"johndoe",value:u,onChange:s=>{E(s.target.value),t.username&&l(a=>({...a,username:void 0}))},className:"bg-background border-border placeholder:text-muted-foreground",autoComplete:"username"}),t.username&&e.jsx("p",{className:"text-sm text-destructive",children:t.username})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"email",children:"Email"}),e.jsx(x,{id:"email",type:"email",placeholder:"you@example.com",value:w,onChange:s=>{k(s.target.value),t.email&&l(a=>({...a,email:void 0}))},className:"bg-background border-border placeholder:text-muted-foreground",autoComplete:"email"}),t.email&&e.jsx("p",{className:"text-sm text-destructive",children:t.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"password",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(x,{id:"password",type:j?"text":"password",placeholder:"Create a strong password",value:o,onChange:s=>{R(s.target.value),t.password&&l(a=>({...a,password:void 0}))},className:"bg-background border-border placeholder:text-muted-foreground pr-10",autoComplete:"new-password"}),e.jsx("button",{type:"button",onClick:()=>F(!j),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:j?e.jsx(_,{className:"h-4 w-4"}):e.jsx(H,{className:"h-4 w-4"})})]}),t.password&&e.jsx("p",{className:"text-sm text-destructive",children:t.password}),o&&e.jsx("div",{className:"mt-2 space-y-1",children:N.map((s,a)=>{const c=s.test(o);return e.jsxs("div",{className:`flex items-center gap-2 text-xs ${c?"text-green-600":"text-muted-foreground"}`,children:[c?e.jsx(L,{className:"h-3 w-3"}):e.jsx(B,{className:"h-3 w-3"}),s.label]},a)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"confirmPassword",children:"Confirm Password"}),e.jsx(x,{id:"confirmPassword",type:j?"text":"password",placeholder:"Confirm your password",value:b,onChange:s=>{A(s.target.value),t.confirmPassword&&l(a=>({...a,confirmPassword:void 0}))},className:"bg-background border-border placeholder:text-muted-foreground",autoComplete:"new-password"}),t.confirmPassword&&e.jsx("p",{className:"text-sm text-destructive",children:t.confirmPassword})]}),e.jsx(D,{type:"submit",className:"w-full bg-cyan-600 hover:bg-cyan-700",disabled:n,children:n?e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating account..."]}):"Create account"}),e.jsxs("p",{className:"text-center text-sm text-muted-foreground",children:["Already have an account?"," ",e.jsx(P,{to:"/signin",className:"text-cyan-600 hover:text-cyan-700 transition-colors",children:"Sign in"})]}),e.jsx("p",{className:"text-center text-xs text-muted-foreground",children:"By creating an account, you agree to our Terms of Service and Privacy Policy."})]})}function Q(){const d=y(),{isAuthenticated:p,currentUser:m}=v(),n=typeof window<"u"?new URLSearchParams(window.location.search).get("redirect_uri"):null,f=z(),i=n&&n.startsWith("/")?n:f??void 0;return r.useEffect(()=>{if(p&&m){if(i){d({to:i});return}d({to:C(m.role)})}},[p,m,d,i]),e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center px-4 py-12",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx(P,{to:"/",className:"inline-block",children:e.jsx("img",{src:"/android-chrome-192x192.png",alt:"Peabee",className:"w-16 h-16 rounded-2xl shadow-lg shadow-cyan-500/25 mx-auto mb-4"})}),e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Create your account"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Start your learning journey today"})]}),e.jsx("div",{className:"bg-card border border-border shadow-sm rounded-xl p-6",children:e.jsx(J,{redirectTo:i})}),e.jsx("p",{className:"text-center text-xs text-muted-foreground mt-8",children:"Peabee"})]})})}export{Q as component};
