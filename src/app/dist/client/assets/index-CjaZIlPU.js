import{c as _e,r as g,bK as St,j as e,bL as oe,bi as pe,bM as de,bN as Dt,bO as kt,bP as Xe,bQ as Ct,bR as Mt,bS as Pt,k as D,a4 as re,N as be,I as F,B as z,X as Tt,e as ge,bT as Ee,bC as Ae,A as Et,U as Oe,aj as he,bn as U,aL as Y,aD as xe,D as Se,a0 as V,E as It,F as le,a as Fe,bU as Rt,W as $t,Y as _t,Z as At,_ as Ot,bV as Ft,a8 as Qe,bW as zt,ar as Ht,s as Bt,d as Lt,u as Ze,ai as Ut,S as Vt,bI as Ke,C as Qt,H as Kt,J as Wt,K as Gt,M as qt,aa as Yt,ab as Jt,t as te}from"./main-oBfCarfk.js";import{g as ze}from"./ai-config-DmDQzXmd.js";import{L as ie}from"./label-D--meCET.js";import{Z as et}from"./zap-BOZaWiPQ.js";import{S as De}from"./sparkles-DJS_NNQ4.js";import{M as Xt}from"./minus-ncef3NoK.js";import{L as tt}from"./list-checks-D31XoYpK.js";import{C as We}from"./circle-check-big-CihxHQxh.js";import{C as Ge}from"./circle-alert-CGSAmO4T.js";import{R as rt}from"./rocket-CSH0mYHf.js";import{A as Zt}from"./arrow-right-CbZwLqfA.js";import"./settings-0j8GZIA_.js";const er=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],tr=_e("ban",er);const rr=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],st=_e("upload",rr);const sr=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],nr=_e("wand-sparkles",sr);var nt=["PageUp","PageDown"],at=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],ot={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},ce="Slider",[Ie,ar,or]=Dt(ce),[it]=Mt(ce,[or]),[ir,ke]=it(ce),lt=g.forwardRef((t,r)=>{const{name:s,min:i=0,max:n=100,step:m=1,orientation:u="horizontal",disabled:c=!1,minStepsBetweenThumbs:f=0,defaultValue:y=[i],value:N,onValueChange:h=()=>{},onValueCommit:x=()=>{},inverted:w=!1,form:M,...o}=t,p=g.useRef(new Set),j=g.useRef(0),I=u==="horizontal"?lr:dr,[R=[],v]=St({prop:N,defaultProp:y,onChange:T=>{[...p.current][j.current]?.focus(),h(T)}}),L=g.useRef(R);function K(T){const $=xr(R,T);G(T,$)}function se(T){G(T,j.current)}function W(){const T=L.current[j.current];R[j.current]!==T&&x(R)}function G(T,$,{commit:A}={commit:!1}){const J=br(m),b=jr(Math.round((T-i)/m)*m+i,J),_=Xe(b,[i,n]);v((C=[])=>{const E=mr(C,_,$);if(pr(E,f*m)){j.current=E.indexOf(_);const H=String(E)!==String(C);return H&&A&&x(E),H?E:C}else return C})}return e.jsx(ir,{scope:t.__scopeSlider,name:s,disabled:c,min:i,max:n,valueIndexToChangeRef:j,thumbs:p.current,values:R,orientation:u,form:M,children:e.jsx(Ie.Provider,{scope:t.__scopeSlider,children:e.jsx(Ie.Slot,{scope:t.__scopeSlider,children:e.jsx(I,{"aria-disabled":c,"data-disabled":c?"":void 0,...o,ref:r,onPointerDown:oe(o.onPointerDown,()=>{c||(L.current=R)}),min:i,max:n,inverted:w,onSlideStart:c?void 0:K,onSlideMove:c?void 0:se,onSlideEnd:c?void 0:W,onHomeKeyDown:()=>!c&&G(i,0,{commit:!0}),onEndKeyDown:()=>!c&&G(n,R.length-1,{commit:!0}),onStepKeyDown:({event:T,direction:$})=>{if(!c){const b=nt.includes(T.key)||T.shiftKey&&at.includes(T.key)?10:1,_=j.current,C=R[_],E=m*b*$;G(C+E,_,{commit:!0})}}})})})})});lt.displayName=ce;var[dt,ct]=it(ce,{startEdge:"left",endEdge:"right",size:"width",direction:1}),lr=g.forwardRef((t,r)=>{const{min:s,max:i,dir:n,inverted:m,onSlideStart:u,onSlideMove:c,onSlideEnd:f,onStepKeyDown:y,...N}=t,[h,x]=g.useState(null),w=de(r,I=>x(I)),M=g.useRef(void 0),o=kt(n),p=o==="ltr",j=p&&!m||!p&&m;function P(I){const R=M.current||h.getBoundingClientRect(),v=[0,R.width],K=He(v,j?[s,i]:[i,s]);return M.current=R,K(I-R.left)}return e.jsx(dt,{scope:t.__scopeSlider,startEdge:j?"left":"right",endEdge:j?"right":"left",direction:j?1:-1,size:"width",children:e.jsx(ut,{dir:o,"data-orientation":"horizontal",...N,ref:w,style:{...N.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:I=>{const R=P(I.clientX);u?.(R)},onSlideMove:I=>{const R=P(I.clientX);c?.(R)},onSlideEnd:()=>{M.current=void 0,f?.()},onStepKeyDown:I=>{const v=ot[j?"from-left":"from-right"].includes(I.key);y?.({event:I,direction:v?-1:1})}})})}),dr=g.forwardRef((t,r)=>{const{min:s,max:i,inverted:n,onSlideStart:m,onSlideMove:u,onSlideEnd:c,onStepKeyDown:f,...y}=t,N=g.useRef(null),h=de(r,N),x=g.useRef(void 0),w=!n;function M(o){const p=x.current||N.current.getBoundingClientRect(),j=[0,p.height],I=He(j,w?[i,s]:[s,i]);return x.current=p,I(o-p.top)}return e.jsx(dt,{scope:t.__scopeSlider,startEdge:w?"bottom":"top",endEdge:w?"top":"bottom",size:"height",direction:w?1:-1,children:e.jsx(ut,{"data-orientation":"vertical",...y,ref:h,style:{...y.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:o=>{const p=M(o.clientY);m?.(p)},onSlideMove:o=>{const p=M(o.clientY);u?.(p)},onSlideEnd:()=>{x.current=void 0,c?.()},onStepKeyDown:o=>{const j=ot[w?"from-bottom":"from-top"].includes(o.key);f?.({event:o,direction:j?-1:1})}})})}),ut=g.forwardRef((t,r)=>{const{__scopeSlider:s,onSlideStart:i,onSlideMove:n,onSlideEnd:m,onHomeKeyDown:u,onEndKeyDown:c,onStepKeyDown:f,...y}=t,N=ke(ce,s);return e.jsx(pe.span,{...y,ref:r,onKeyDown:oe(t.onKeyDown,h=>{h.key==="Home"?(u(h),h.preventDefault()):h.key==="End"?(c(h),h.preventDefault()):nt.concat(at).includes(h.key)&&(f(h),h.preventDefault())}),onPointerDown:oe(t.onPointerDown,h=>{const x=h.target;x.setPointerCapture(h.pointerId),h.preventDefault(),N.thumbs.has(x)?x.focus():i(h)}),onPointerMove:oe(t.onPointerMove,h=>{h.target.hasPointerCapture(h.pointerId)&&n(h)}),onPointerUp:oe(t.onPointerUp,h=>{const x=h.target;x.hasPointerCapture(h.pointerId)&&(x.releasePointerCapture(h.pointerId),m(h))})})}),mt="SliderTrack",ht=g.forwardRef((t,r)=>{const{__scopeSlider:s,...i}=t,n=ke(mt,s);return e.jsx(pe.span,{"data-disabled":n.disabled?"":void 0,"data-orientation":n.orientation,...i,ref:r})});ht.displayName=mt;var Re="SliderRange",xt=g.forwardRef((t,r)=>{const{__scopeSlider:s,...i}=t,n=ke(Re,s),m=ct(Re,s),u=g.useRef(null),c=de(r,u),f=n.values.length,y=n.values.map(x=>pt(x,n.min,n.max)),N=f>1?Math.min(...y):0,h=100-Math.max(...y);return e.jsx(pe.span,{"data-orientation":n.orientation,"data-disabled":n.disabled?"":void 0,...i,ref:c,style:{...t.style,[m.startEdge]:N+"%",[m.endEdge]:h+"%"}})});xt.displayName=Re;var $e="SliderThumb",gt=g.forwardRef((t,r)=>{const s=ar(t.__scopeSlider),[i,n]=g.useState(null),m=de(r,c=>n(c)),u=g.useMemo(()=>i?s().findIndex(c=>c.ref.current===i):-1,[s,i]);return e.jsx(cr,{...t,ref:m,index:u})}),cr=g.forwardRef((t,r)=>{const{__scopeSlider:s,index:i,name:n,...m}=t,u=ke($e,s),c=ct($e,s),[f,y]=g.useState(null),N=de(r,P=>y(P)),h=f?u.form||!!f.closest("form"):!0,x=Ct(f),w=u.values[i],M=w===void 0?0:pt(w,u.min,u.max),o=hr(i,u.values.length),p=x?.[c.size],j=p?gr(p,M,c.direction):0;return g.useEffect(()=>{if(f)return u.thumbs.add(f),()=>{u.thumbs.delete(f)}},[f,u.thumbs]),e.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[c.startEdge]:`calc(${M}% + ${j}px)`},children:[e.jsx(Ie.ItemSlot,{scope:t.__scopeSlider,children:e.jsx(pe.span,{role:"slider","aria-label":t["aria-label"]||o,"aria-valuemin":u.min,"aria-valuenow":w,"aria-valuemax":u.max,"aria-orientation":u.orientation,"data-orientation":u.orientation,"data-disabled":u.disabled?"":void 0,tabIndex:u.disabled?void 0:0,...m,ref:N,style:w===void 0?{display:"none"}:t.style,onFocus:oe(t.onFocus,()=>{u.valueIndexToChangeRef.current=i})})}),h&&e.jsx(ft,{name:n??(u.name?u.name+(u.values.length>1?"[]":""):void 0),form:u.form,value:w},i)]})});gt.displayName=$e;var ur="RadioBubbleInput",ft=g.forwardRef(({__scopeSlider:t,value:r,...s},i)=>{const n=g.useRef(null),m=de(n,i),u=Pt(r);return g.useEffect(()=>{const c=n.current;if(!c)return;const f=window.HTMLInputElement.prototype,N=Object.getOwnPropertyDescriptor(f,"value").set;if(u!==r&&N){const h=new Event("input",{bubbles:!0});N.call(c,r),c.dispatchEvent(h)}},[u,r]),e.jsx(pe.input,{style:{display:"none"},...s,ref:m,defaultValue:r})});ft.displayName=ur;function mr(t=[],r,s){const i=[...t];return i[s]=r,i.sort((n,m)=>n-m)}function pt(t,r,s){const m=100/(s-r)*(t-r);return Xe(m,[0,100])}function hr(t,r){return r>2?`Value ${t+1} of ${r}`:r===2?["Minimum","Maximum"][t]:void 0}function xr(t,r){if(t.length===1)return 0;const s=t.map(n=>Math.abs(n-r)),i=Math.min(...s);return s.indexOf(i)}function gr(t,r,s){const i=t/2,m=He([0,50],[0,i]);return(i-m(r)*s)*s}function fr(t){return t.slice(0,-1).map((r,s)=>t[s+1]-r)}function pr(t,r){if(r>0){const s=fr(t);return Math.min(...s)>=r}return!0}function He(t,r){return s=>{if(t[0]===t[1]||r[0]===r[1])return r[0];const i=(r[1]-r[0])/(t[1]-t[0]);return r[0]+i*(s-t[0])}}function br(t){return(String(t).split(".")[1]||"").length}function jr(t,r){const s=Math.pow(10,r);return Math.round(t*s)/s}var bt=lt,vr=ht,yr=xt,Nr=gt;const fe=g.forwardRef(({className:t,...r},s)=>e.jsxs(bt,{ref:s,className:D("relative flex w-full touch-none select-none items-center",t),...r,children:[e.jsx(vr,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:e.jsx(yr,{className:"absolute h-full bg-primary"})}),e.jsx(Nr,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 cursor-pointer"})]}));fe.displayName=bt.displayName;const wr=[{id:"manual",icon:be,title:"Manual Builder",description:"Create your project from scratch with full control over every detail.",recommended:!1},{id:"keyword",icon:nr,title:"Keyword Generator",description:"Enter keywords and let AI generate a project structure for you.",recommended:!0},{id:"quickstart",icon:et,title:"Quick Start",description:"Configure all settings at once with demo defaults. Perfect for testing.",recommended:!1,special:!0},{id:"document",icon:st,title:"Document-Driven",description:"Upload your syllabus or lecture materials and AI will auto-generate a project.",recommended:!1}];function Sr(){const{wizardState:t,setWizardMode:r}=re(),{mode:s}=t,i=n=>{r(n)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground mb-2",children:"How would you like to create your project?"}),e.jsx("p",{className:"text-muted-foreground",children:"Choose a creation mode that fits your workflow"})]}),e.jsx("div",{className:"grid grid-cols-4 gap-4",children:wr.map(n=>{const m=n.icon,u=s===n.id;return e.jsxs("button",{onClick:()=>i(n.id),className:D("relative p-6 rounded-xl border-2 text-left transition-all",u?n.id==="quickstart"?"border-purple-500 bg-purple-500/10":"border-cyan-500 bg-cyan-500/10":"border-border bg-card hover:border-border/70"),children:[n.recommended&&e.jsx("span",{className:"absolute -top-3 left-1/2 -translate-x-1/2 px-2 py-0.5 bg-cyan-600 text-white text-xs rounded-full",children:"Recommended"}),n.id==="quickstart"&&e.jsx("span",{className:"absolute -top-3 left-1/2 -translate-x-1/2 px-2 py-0.5 bg-purple-600 text-white text-xs rounded-full",children:"Fastest"}),e.jsx("div",{className:D("w-12 h-12 rounded-lg flex items-center justify-center mb-4",u?n.id==="quickstart"?"bg-purple-500/20 text-purple-500":"bg-cyan-500/20 text-cyan-500":"bg-muted text-muted-foreground"),children:e.jsx(m,{className:"w-6 h-6"})}),e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:n.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:n.description}),e.jsx("div",{className:D("absolute top-4 right-4 w-5 h-5 rounded-full border-2 flex items-center justify-center",u?n.id==="quickstart"?"border-purple-500 bg-purple-500":"border-cyan-500 bg-cyan-500":"border-border"),children:u&&e.jsx("div",{className:"w-2 h-2 rounded-full bg-white"})})]},n.id)})})]})}const Dr=`You are an expert educational project designer for Peabee.
Your task is to generate a compelling project title, background context, and driving question based on keywords provided by educators.

Guidelines:
- Title: Create an engaging, concise project title (5-10 words) that captures the essence of the learning experience
- Background: Write 2-3 sentences providing context about why this objective matters and what will be explored
- Driving Question: Craft an open-ended, thought-provoking question that will guide inquiry throughout the project
- IMPORTANT: Do NOT use the word "student" or "students" anywhere in the output. Use "learner", "participant", "team", or rephrase to avoid addressing anyone directly.`,kr={type:"object",properties:{title:{type:"string",description:"Engaging project title (5-10 words)"},background:{type:"string",description:"2-3 sentences of context"},drivingQuestion:{type:"string",description:"Open-ended guiding question"}},required:["title","background","drivingQuestion"],additionalProperties:!1};async function Cr(t){let r;try{r=await ze()}catch(n){console.error("Error getting AI model, using default:",n),r="openrouter/auto"}const s=await Ae({data:{model:r,messages:[{role:"system",content:Dr},{role:"user",content:`Generate a project based on these keywords: ${t}`}],max_tokens:500,temperature:.8,response_format:{type:"json_schema",json_schema:{name:"project_response",strict:!0,schema:kr}}}});if(!s.success)throw new Error(s.error||"AI API error");const i=s.content;if(!i)throw new Error("No content in API response");try{let n=i.trim();const m=n.match(/```(?:json)?\s*([\s\S]*?)```/);m&&(n=m[1].trim());const u=n.match(/\{[\s\S]*\}/);u&&(n=u[0]);const c=JSON.parse(n);return{title:c.title||"",background:c.background||"",drivingQuestion:c.drivingQuestion||""}}catch(n){throw console.error("Failed to parse JSON response:",i,n),new Error("Failed to parse AI response. Please try again.")}}function Mr(){const{wizardState:t,updateBasicInfo:r}=re(),{mode:s,basicInfo:i,uploadedFiles:n,ragProcessingStatus:m,validationErrors:u}=t,[c,f]=g.useState(""),[y,N]=g.useState(!1),[h,x]=g.useState(null),w=o=>{const p=o.target.files;p&&console.log("Files uploaded:",p)},M=async()=>{if(c.trim()){N(!0),x(null);try{const o=await Cr(c);r(o)}catch(o){console.error("Generation error:",o),x(o instanceof Error?o.message:"Failed to generate project. Please try again.")}finally{N(!1)}}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground mb-2",children:"Content Analysis & Setup"}),e.jsx("p",{className:"text-muted-foreground",children:"Define your project's foundation"})]}),s==="document"&&e.jsxs("div",{className:"p-6 border-2 border-dashed border-border rounded-xl bg-muted/20",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(st,{className:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-foreground mb-2",children:"Upload Course Materials"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Drag and drop or click to upload syllabus, lecture notes, or assignments (PDF, DOCX, PPTX)"}),e.jsx(F,{type:"file",accept:".pdf,.docx,.pptx,.doc,.ppt",multiple:!0,onChange:w,className:"hidden",id:"file-upload"}),e.jsx("label",{htmlFor:"file-upload",children:e.jsx(z,{variant:"outline",asChild:!0,children:e.jsxs("span",{className:"cursor-pointer",children:[e.jsx(be,{className:"w-4 h-4 mr-2"}),"Select Files"]})})})]}),n.length>0&&e.jsx("div",{className:"mt-4 space-y-2",children:n.map(o=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-muted rounded",children:[e.jsx("span",{className:"text-sm text-foreground",children:o.name}),e.jsx(z,{variant:"ghost",size:"icon",className:"h-6 w-6",children:e.jsx(Tt,{className:"w-4 h-4"})})]},o.id))}),m==="processing"&&e.jsxs("div",{className:"mt-4 flex items-center justify-center gap-2 text-cyan-500",children:[e.jsx(ge,{className:"w-4 h-4 animate-spin"}),"Processing documents with AI..."]})]}),s==="keyword"&&e.jsxs("div",{className:"p-6 bg-card rounded-xl border border-border",children:[e.jsx(ie,{className:"text-foreground mb-2 block",children:"Enter Keywords"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(F,{value:c,onChange:o=>f(o.target.value),placeholder:"e.g., machine learning, data science, python",className:"bg-background border-border"}),e.jsx(z,{onClick:M,disabled:y||!c.trim(),className:"bg-gradient-to-r from-purple-600 to-cyan-600 hover:from-purple-700 hover:to-cyan-700 text-white",children:y?e.jsx(ge,{className:"w-4 h-4 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(De,{className:"w-4 h-4 mr-2"}),"Generate"]})})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Enter comma-separated keywords related to your project objective"}),h&&e.jsx("p",{className:"text-xs text-red-400 mt-2",children:h})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs(ie,{htmlFor:"title",className:"text-foreground",children:["Project Title ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx(F,{id:"title",value:i.title,onChange:o=>r({title:o.target.value}),placeholder:"Enter a descriptive project title",className:`mt-1 bg-background border-border ${u.title?"border-red-500":""}`}),u.title&&e.jsx("p",{className:"text-xs text-red-400 mt-1",children:u.title})]}),e.jsxs("div",{children:[e.jsx(ie,{htmlFor:"background",className:"text-foreground",children:"Background"}),e.jsx(Ee,{id:"background",value:i.background,onChange:o=>r({background:o.target.value}),placeholder:"Provide context and background for the project",className:"mt-1 bg-background border-border min-h-[100px]"})]}),e.jsxs("div",{children:[e.jsxs(ie,{htmlFor:"drivingQuestion",className:"text-foreground",children:["Driving Question ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx(Ee,{id:"drivingQuestion",value:i.drivingQuestion,onChange:o=>r({drivingQuestion:o.target.value}),placeholder:"What is the central question students will explore?",className:`mt-1 bg-background border-border ${u.drivingQuestion?"border-red-500":""}`}),u.drivingQuestion&&e.jsx("p",{className:"text-xs text-red-400 mt-1",children:u.drivingQuestion}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"A good driving question is open-ended, engaging, and connects to real-world problems"})]})]})]})}function Pr(){const{wizardState:t,updateParticipantParams:r}=re(),{participantParams:s,validationErrors:i}=t,n=2,m=10,u=c=>Math.min(m,Math.max(n,c));return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground mb-2",children:"Team Formation"}),e.jsx("p",{className:"text-muted-foreground",children:"Choose how explorers will work on this project"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:()=>r({projectMode:"personal"}),className:D("p-6 rounded-xl border-2 text-left transition-all",s.projectMode==="personal"?"border-cyan-500 bg-cyan-500/10":"border-border bg-card hover:border-border/70"),children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:D("w-12 h-12 rounded-lg flex items-center justify-center",s.projectMode==="personal"?"bg-cyan-500/20 text-cyan-500":"bg-muted text-muted-foreground"),children:e.jsx(Et,{className:"w-6 h-6"})}),e.jsx("h3",{className:"text-xl font-semibold text-foreground",children:"Personal"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Each explorer works individually on their own project."})]}),e.jsxs("button",{onClick:()=>r({projectMode:"team"}),className:D("p-6 rounded-xl border-2 text-left transition-all",s.projectMode==="team"?"border-cyan-500 bg-cyan-500/10":"border-border bg-card hover:border-border/70"),children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:D("w-12 h-12 rounded-lg flex items-center justify-center",s.projectMode==="team"?"bg-cyan-500/20 text-cyan-500":"bg-muted text-muted-foreground"),children:e.jsx(Oe,{className:"w-6 h-6"})}),e.jsx("h3",{className:"text-xl font-semibold text-foreground",children:"Team"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Explorers collaborate together in teams."})]})]}),s.projectMode==="team"&&e.jsxs("div",{className:"py-8 px-6 bg-card rounded-xl border border-border",children:[e.jsxs("label",{className:"text-sm font-medium text-foreground mb-4 block text-center",children:["Team Size ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs("div",{className:"flex items-center justify-center gap-4",children:[e.jsx(z,{type:"button",variant:"outline",size:"icon-lg",onClick:()=>r({teamSize:u(s.teamSize-1)}),disabled:s.teamSize<=n,className:"h-14 w-14",children:e.jsx(Xt,{className:"w-5 h-5"})}),e.jsx(F,{type:"number",min:n,max:m,value:s.teamSize,onChange:c=>r({teamSize:u(parseInt(c.target.value,10)||n)}),className:D("bg-background border-border w-32 h-14 text-center text-2xl font-semibold",i.teamSize&&"border-red-500")}),e.jsx(z,{type:"button",variant:"outline",size:"icon-lg",onClick:()=>r({teamSize:u(s.teamSize+1)}),disabled:s.teamSize>=m,className:"h-14 w-14",children:e.jsx(he,{className:"w-5 h-5"})}),e.jsx("span",{className:"text-muted-foreground text-base",children:"members per team"})]}),i.teamSize&&e.jsx("p",{className:"text-xs text-red-400 mt-3 text-center",children:i.teamSize})]})]})}const ee=[{label:"5min",minutes:5},{label:"10min",minutes:10},{label:"15min",minutes:15},{label:"30min",minutes:30},{label:"1hour",minutes:60},{label:"2hours",minutes:120},{label:"4hours",minutes:240},{label:"8hours",minutes:480},{label:"1day",minutes:1440},{label:"2days",minutes:2880},{label:"1week",minutes:10080},{label:"2weeks",minutes:20160},{label:"4weeks",minutes:40320},{label:"8weeks",minutes:80640},{label:"16weeks",minutes:161280}];function Me(t){let r=0,s=Math.abs(ee[0].minutes-t);for(let i=1;i<ee.length;i++){const n=Math.abs(ee[i].minutes-t);n<s&&(s=n,r=i)}return r}function Tr(t){if(t<60)return`${t} minutes`;if(t<1440){const r=Math.floor(t/60),s=t%60;return s>0?`${r}h ${s}m`:`${r} hour${r>1?"s":""}`}else if(t<10080){const r=Math.floor(t/1440),s=Math.floor(t%1440/60);return s>0?`${r}d ${s}h`:`${r} day${r>1?"s":""}`}else{const r=Math.floor(t/10080),s=Math.floor(t%10080/1440);return s>0?`${r}w ${s}d`:`${r} week${r>1?"s":""}`}}function Er(){const{wizardState:t,setTimeline:r}=re(),{timeline:s,validationErrors:i}=t;g.useEffect(()=>{if(!U(s.startDate)||!U(s.endDate)){const o=new Date;o.setMinutes(Math.ceil(o.getMinutes()/15)*15,0,0);const p=Y(o,10),j=Y(p,5);r({startDate:p.toISOString(),endDate:j.toISOString()})}},[s.startDate,s.endDate,r]);const n=g.useMemo(()=>{if(U(s.startDate))return new Date(s.startDate);const o=new Date;return o.setMinutes(Math.ceil(o.getMinutes()/15)*15,0,0),Y(o,10)},[s.startDate]),m=g.useMemo(()=>U(s.endDate)?new Date(s.endDate):Y(n,5),[s.endDate,n]),u=g.useMemo(()=>xe(m,n),[n,m]),[c,f]=g.useState(()=>Me(u)),y=o=>{const p=o[0];f(p);const j=ee[p],P=Y(n,j.minutes);r({startDate:n.toISOString(),endDate:P.toISOString()})},N=o=>{if(!o)return;const[p,j]=[o,V(n,"HH:mm")],P=new Date(`${p}T${j}`),I=Y(P,u);r({startDate:P.toISOString(),endDate:I.toISOString()})},h=o=>{if(!o)return;const p=V(n,"yyyy-MM-dd"),j=new Date(`${p}T${o}`),P=Y(j,u);r({startDate:j.toISOString(),endDate:P.toISOString()})},x=o=>{if(!o)return;const p=V(m,"HH:mm"),j=new Date(`${o}T${p}`);r({startDate:n.toISOString(),endDate:j.toISOString()});const P=xe(j,n);f(Me(P))},w=o=>{if(!o)return;const p=V(m,"yyyy-MM-dd"),j=new Date(`${p}T${o}`);r({startDate:n.toISOString(),endDate:j.toISOString()});const P=xe(j,n);f(Me(P))},M=o=>{f(o);const p=ee[o],j=Y(n,p.minutes);r({startDate:n.toISOString(),endDate:j.toISOString()})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground mb-2",children:"Project Duration"}),e.jsx("p",{className:"text-muted-foreground",children:"Set the start and end dates with times for your project"})]}),e.jsxs("div",{className:"p-4 bg-card rounded-xl border border-border",children:[e.jsx("label",{className:"text-sm font-medium text-foreground mb-3 block",children:"Quick Duration Selector"}),e.jsx("div",{className:"grid gap-1",style:{gridTemplateColumns:`repeat(${ee.length}, 1fr)`},children:ee.map((o,p)=>e.jsx("button",{onClick:()=>M(p),className:D("py-1.5 rounded text-xs font-medium text-center transition-all",c===p?"bg-cyan-500 text-white":"bg-muted text-muted-foreground hover:bg-muted/80 hover:text-foreground"),children:o.label},o.label))}),e.jsx("div",{className:"mt-3 px-1",children:e.jsx(fe,{value:[c],onValueChange:y,max:ee.length-1,step:1,className:"w-full"})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"p-4 bg-muted/40 rounded-xl border border-border",children:[e.jsxs("label",{className:"text-sm font-medium text-foreground mb-3 block",children:[e.jsx(Se,{className:"w-4 h-4 inline mr-2"}),"Start Date & Time ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-muted-foreground mb-1 block",children:"Date"}),e.jsx(F,{type:"date",value:V(n,"yyyy-MM-dd"),onChange:o=>N(o.target.value),className:D("bg-background border-border",i.startDate&&"border-red-500")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-muted-foreground mb-1 block",children:"Time"}),e.jsx(F,{type:"time",value:V(n,"HH:mm"),onChange:o=>h(o.target.value),className:"bg-background border-border"})]})]}),i.startDate&&e.jsx("p",{className:"text-xs text-red-400 mt-2",children:i.startDate})]}),e.jsxs("div",{className:"p-4 bg-muted/40 rounded-xl border border-border",children:[e.jsxs("label",{className:"text-sm font-medium text-foreground mb-3 block",children:[e.jsx(Se,{className:"w-4 h-4 inline mr-2"}),"End Date & Time ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-muted-foreground mb-1 block",children:"Date"}),e.jsx(F,{type:"date",value:V(m,"yyyy-MM-dd"),min:V(n,"yyyy-MM-dd"),onChange:o=>x(o.target.value),className:D("bg-background border-border",i.endDate&&"border-red-500")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-muted-foreground mb-1 block",children:"Time"}),e.jsx(F,{type:"time",value:V(m,"HH:mm"),onChange:o=>w(o.target.value),className:"bg-background border-border"})]})]}),i.endDate&&e.jsx("p",{className:"text-xs text-red-400 mt-2",children:i.endDate})]})]}),u>0&&e.jsxs("div",{className:"p-6 bg-gradient-to-br from-cyan-500/10 to-blue-500/10 rounded-xl border border-cyan-500/30",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-xl bg-cyan-500/20 flex items-center justify-center",children:e.jsx(It,{className:"w-7 h-7 text-cyan-500"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-3xl font-bold text-foreground",children:Tr(u)}),e.jsx("div",{className:"text-muted-foreground",children:"Total project duration"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-foreground",children:le(n.toISOString(),"MMM d, yyyy HH:mm","Not set")}),e.jsx("div",{className:"text-xs text-muted-foreground my-1",children:"to"}),e.jsx("div",{className:"text-sm text-foreground",children:le(m.toISOString(),"MMM d, yyyy HH:mm","Not set")})]})]}),e.jsxs("div",{className:"mt-6 pt-4 border-t border-border/50",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-green-500 shadow-lg shadow-green-500/30"}),e.jsx("div",{className:"flex-1 h-2 bg-gradient-to-r from-green-500 via-cyan-500 to-blue-500 rounded-full mx-2"}),e.jsx("div",{className:"w-4 h-4 rounded-full bg-blue-500 shadow-lg shadow-blue-500/30"})]}),e.jsxs("div",{className:"flex justify-between mt-2 text-xs text-muted-foreground",children:[e.jsx("span",{children:"Project Start"}),e.jsx("span",{children:"Project End"})]})]})]}),e.jsxs("div",{className:"p-4 bg-muted/40 rounded-lg border border-border",children:[e.jsx("h4",{className:"text-sm font-medium text-foreground mb-2",children:"Timeline Tips"}),e.jsxs("ul",{className:"text-sm text-muted-foreground space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"Use the slider for quick duration selection"}),e.jsx("li",{children:"Short durations (15min-8hours) are great for workshops or class sessions"}),e.jsx("li",{children:"Longer durations (weeks) are better for semester-long projects"}),e.jsx("li",{children:"You can fine-tune individual session durations in the next steps"})]})]})]})}const Ir=[{value:"none",label:"None",icon:tr},{value:"document",label:"Document",icon:be}],Rr=[{value:"easy",label:"Easy",bgColor:"bg-sky-500",textColor:"text-sky-600",borderColor:"border-sky-500"},{value:"medium",label:"Medium",bgColor:"bg-violet-500",textColor:"text-violet-600",borderColor:"border-violet-500"},{value:"hard",label:"Hard",bgColor:"bg-rose-500",textColor:"text-rose-600",borderColor:"border-rose-500"}],Pe={easy:60,medium:100,hard:140};function jt(t){if(t<60)return`${t} min`;if(t<1440){const r=Math.round(t/60);return`${r} hour${r>1?"s":""}`}else if(t<10080){const r=Math.round(t/1440);return`${r} day${r>1?"s":""}`}else{const r=Math.round(t/10080);return`${r} week${r>1?"s":""}`}}function Te(t,r){if(r<1440)return t<60?`${t} min`:`${Math.round(t/60*10)/10}h`;if(r<10080)return t<1440?`${Math.round(t/60)}h`:`${Math.round(t/1440*10)/10}d`;{const s=Math.round(t/1440);return`${s} day${s>1?"s":""}`}}const $r=(t,r)=>`You are an expert educational project designer for Peabee.
Your task is to generate appropriate learning sessions based on the project information provided.

Guidelines:
- Create sessions that scaffold learning from foundational concepts to complex applications
- Each session should have a clear learning objective tied to the driving question
- Difficulty should progress: typically start with easy/medium, build to hard, then consolidate
- Time allocation based on difficulty: easy (shorter), medium (standard), hard (longer)
- Rubric criteria should be specific, measurable, and aligned with session objectives
- IMPORTANT: Do NOT prefix or number session titles with labels like "Session 1:", "Session 2:", etc. Use descriptive, content-based titles only.
- IMPORTANT: Do NOT use the word "student" or "students" anywhere in the output â€” not in titles, topics, guides, rubric criteria, or rubric descriptions. Use "learner", "participant", "team", or rephrase to avoid addressing anyone directly.
- Thinking Style (Divergence Level): ${t}/100 (0 = Highly Convergent/Structured, 100 = Highly Divergent/Creative).
  - Low divergence: Detailed guides, specific document deliverables, strict rubrics.
  - High divergence: Open-ended guides, creative deliverables, flexible rubrics.
- Tone/Style: ${r}/100 (0 = Professional/Formal, 100 = Fun/Casual).
  - Low (0-30): Strictly professional, academic, formal tone.
  - Mid (31-70): Balanced tone. Professional but accessible and engaging.
  - High (71-100): Fun, engaging, casual tone. Use emojis, exciting language.

For each session, provide:
- title: Concise session title (3-7 words)
- topic: What will be learned/done in this session (1-2 sentences)
- difficulty: "easy", "medium", or "hard"
- guide: Detailed instructions for the session (2-3 paragraphs)
- deliverableType: "none" or "document" based on the project nature and divergence level
 - rubric: Array of 3-4 criteria, each with criterion name, description, and weight (integer percentage 0-100, no decimals, weights must sum to exactly 100)`,_r={type:"object",properties:{sessions:{type:"array",items:{type:"object",properties:{title:{type:"string"},topic:{type:"string"},difficulty:{type:"string",enum:["easy","medium","hard"]},guide:{type:"string"},deliverableType:{type:"string",enum:["none","document"]},rubric:{type:"array",items:{type:"object",properties:{criterion:{type:"string"},description:{type:"string"},weight:{type:"integer",minimum:0,maximum:100}},required:["criterion","description","weight"],additionalProperties:!1}}},required:["title","topic","difficulty","guide","deliverableType","rubric"],additionalProperties:!1}}},required:["sessions"],additionalProperties:!1};async function Ar(t,r,s,i,n,m,u){const c=jt(i);let f;try{f=await ze()}catch(h){console.error("Error getting AI model, using default:",h),f="openrouter/auto"}const y=await Ae({data:{model:f,messages:[{role:"system",content:$r(m,u)},{role:"user",content:`Generate exactly ${n} learning sessions for this project:

Project Title: ${t}
Background: ${r}
Driving Question: ${s}
Total Duration: ${c}

Create a well-structured learning journey that helps answer the driving question.`}],max_tokens:3e3,temperature:.7+m/100*.3,response_format:{type:"json_schema",json_schema:{name:"sessions_response",strict:!0,schema:_r}}}});if(!y.success)throw new Error(y.error||"AI API error");const N=y.content;if(!N)throw new Error("No content in API response");try{let h=N.trim();const x=h.match(/```(?:json)?\s*([\s\S]*?)```/);x&&(h=x[1].trim());const w=h.match(/\{[\s\S]*\}/);return w&&(h=w[0]),JSON.parse(h).sessions.map(o=>({title:o.title||"",topic:o.topic||"",difficulty:["easy","medium","hard"].includes(o.difficulty)?o.difficulty:"medium",guide:o.guide||"",deliverableType:["none","document"].includes(o.deliverableType)?o.deliverableType:"document",rubric:(o.rubric||[]).map(p=>({criterion:p.criterion||"",description:p.description||"",weight:p.weight||25}))}))}catch(h){throw console.error("Failed to parse JSON response:",N,h),new Error("Failed to parse AI response. Please try again.")}}function qe(t){return t<=0?1:t<=60?3:t<=240?4:t<=480?5:t<=1440||t<=10080?3:t<=20160?5:t<=40320?6:(t<=80640,8)}function Or(){const{wizardState:t,addSession:r,updateSession:s,removeSession:i,setSessions:n}=re(),{currentUser:m,setUser:u}=Fe(),{sessions:c,timeline:f,basicInfo:y,validationErrors:N}=t,[h,x]=g.useState(null),[w,M]=g.useState(!1),[o,p]=g.useState(null),[j,P]=g.useState([50]),[I,R]=g.useState([50]),[v,L]=g.useState(null),K=g.useRef(null),[se,W]=g.useState(null),[G,T]=g.useState(null),$=g.useMemo(()=>!U(f.startDate)||!U(f.endDate)?0:xe(new Date(f.endDate),new Date(f.startDate)),[f.startDate,f.endDate]),[A,J]=g.useState(()=>qe($)),b=g.useCallback(async l=>{if(m?.id)try{const a=await Rt({data:{userId:m.id,defaultSessionDifficulty:l}});a.success&&u({...m,defaultSessionDifficulty:a.user.defaultSessionDifficulty??l})}catch(a){console.error("Failed to save default session difficulty:",a)}},[m,u]),_=c.reduce((l,a)=>l+a.weight,0),C=g.useMemo(()=>{if(!U(f.startDate)||c.length===0)return c.map((a,d)=>({...a,index:d,calculatedStartDate:"",calculatedEndDate:"",isoStartDate:"",isoEndDate:"",sessionMinutes:0,percentage:c.length>0?Math.round(100/c.length):0}));let l=new Date(f.startDate);return c.map((a,d)=>{const S=_>0?a.weight/_:0,k=Math.max(1,Math.round($*S)),B=l,O=Y(l,k);return l=O,{...a,index:d,calculatedStartDate:V(B,"yyyy-MM-dd HH:mm"),calculatedEndDate:V(O,"yyyy-MM-dd HH:mm"),isoStartDate:B.toISOString(),isoEndDate:O.toISOString(),sessionMinutes:k,percentage:Math.round(S*100)}})},[c,f.startDate,$,_]),E=g.useCallback(l=>{if(v===null||!K.current)return;const a=K.current.getBoundingClientRect(),d=l.clientX-a.left,S=a.width;let k=0;for(let Ce=0;Ce<v;Ce++)k+=C[Ce]?.percentage||0;const B=Math.max(5,Math.min(95,d/S*100)),O=c[v],Be=c[v+1];if(!O||!Be)return;const vt=C[v]?.percentage||0,yt=C[v+1]?.percentage||0,Le=vt+yt,Nt=Math.max(5,Math.min(Le-5,B-k)),Ue=O.weight+Be.weight,Ve=Math.max(1,Math.round(Nt/Le*Ue)),wt=Math.max(1,Ue-Ve);s(v,{weight:Ve}),s(v+1,{weight:wt})},[v,c,C,s]),H=g.useCallback(()=>{L(null)},[]);g.useEffect(()=>{if(v!==null){const l=d=>E(d),a=()=>H();return window.addEventListener("mousemove",l),window.addEventListener("mouseup",a),()=>{window.removeEventListener("mousemove",l),window.removeEventListener("mouseup",a)}}},[v,E,H]);const Q=(l,a)=>{l.dataTransfer.effectAllowed="move",l.dataTransfer.setData("text/plain",a.toString()),W(a)},je=(l,a)=>{l.preventDefault(),l.dataTransfer.dropEffect="move",T(a)},ve=()=>{T(null)},ne=(l,a)=>{l.preventDefault();const d=se;if(d===null||d===a){W(null),T(null);return}const S=[...c],[k]=S.splice(d,1);S.splice(a,0,k),n(S),W(null),T(null),h===d?x(a):h!==null&&(d<h&&a>=h?x(h-1):d>h&&a<=h&&x(h+1))},ue=()=>{W(null),T(null)};g.useEffect(()=>{if(!U(f.startDate))return;if(C.forEach((a,d)=>{const S=c[d];S.startDate!==a.isoStartDate||(S.endDate,a.isoEndDate)}),C.some((a,d)=>{const S=c[d];return S.startDate!==a.isoStartDate||S.endDate!==a.isoEndDate||S.durationMinutes!==a.sessionMinutes})){const a=c.map((d,S)=>{const k=C[S];return{...d,durationMinutes:k.sessionMinutes,startDate:k.isoStartDate,endDate:k.isoEndDate}});n(a)}},[C,c,n,f.startDate]);const me=async()=>{if(!y.title||!y.drivingQuestion){p("Please fill in project title and driving question first (Step 2: Content)");return}M(!0),p(null);try{const a=(await Ar(y.title,y.background,y.drivingQuestion,$||20160,A,j[0],I[0])).map((d,S)=>({index:S,title:d.title,topic:d.topic,guide:d.guide,difficulty:d.difficulty,weight:Pe[d.difficulty],durationMinutes:Pe[d.difficulty],startDate:"",endDate:"",deliverableType:d.deliverableType,rubric:d.rubric.map(k=>({id:`rubric_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,...k})),resources:[],templates:[],llmModel:"gpt-4"}));n(a),x(0)}catch(l){console.error("Generation error:",l),p(l instanceof Error?l.message:"Failed to generate sessions. Please try again.")}finally{M(!1)}},ye=l=>{const a=c[l].rubric||[],d=a.reduce((B,O)=>B+O.weight,0),S=Math.max(0,100-d),k={id:`rubric_${Date.now()}`,criterion:"",description:"",weight:S};s(l,{rubric:[...a,k]})},X=(l,a,d)=>{const S=[...c[l].rubric||[]];S[a]={...S[a],...d},s(l,{rubric:S})},Ne=(l,a)=>{const d=c[l].rubric.filter((S,k)=>k!==a);s(l,{rubric:d})},ae=qe($),q=l=>$<1440?le(l,"MMM d HH:mm","?"):le(l,"MMM d","?");return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground mb-2",children:"Variable Session Builder"}),e.jsx("p",{className:"text-muted-foreground",children:"AI generates sessions based on your project info. Customize as needed."})]}),e.jsxs("div",{className:"p-4 bg-card rounded-xl border border-border space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-8",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Project Duration"}),e.jsx("div",{className:"text-foreground font-medium",children:$>0?e.jsxs(e.Fragment,{children:[jt($),e.jsxs("span",{className:"text-muted-foreground font-normal ml-2 text-sm",children:["(",q(f.startDate)," -"," ",q(f.endDate),")"]})]}):e.jsx("span",{className:"text-muted-foreground",children:"Not set"})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-xs text-muted-foreground mb-1",children:["Number of Sessions",A===ae&&e.jsx("span",{className:"text-cyan-500 ml-1",children:"(recommended)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>J(Math.max(1,A-1)),className:"w-8 h-8 rounded-lg bg-muted hover:bg-muted/80 text-foreground flex items-center justify-center transition-colors",disabled:A<=1,children:"-"}),e.jsx("span",{className:"w-8 text-center text-xl font-bold text-foreground",children:A}),e.jsx("button",{onClick:()=>J(Math.min(10,A+1)),className:"w-8 h-8 rounded-lg bg-muted hover:bg-muted/80 text-foreground flex items-center justify-center transition-colors",disabled:A>=10,children:"+"}),A!==ae&&e.jsxs("button",{onClick:()=>J(ae),className:"text-xs text-cyan-500 hover:text-cyan-600 ml-2",children:["Reset to ",ae]})]})]})]}),e.jsx(z,{onClick:me,disabled:w||!y.title,className:"bg-gradient-to-r from-purple-600 to-cyan-600 hover:from-purple-700 hover:to-cyan-700 text-white",children:w?e.jsxs(e.Fragment,{children:[e.jsx(ge,{className:"w-4 h-4 mr-2 animate-spin"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(De,{className:"w-4 h-4 mr-2"}),"Generate ",A," Sessions"]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-8 pt-4 border-t border-border/50",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground mb-3",children:[e.jsx("span",{children:"Convergent"}),e.jsx("span",{className:"text-cyan-500 font-medium",children:"Thinking Style"}),e.jsx("span",{children:"Divergent"})]}),e.jsx(fe,{value:j,onValueChange:P,max:100,step:50,className:"py-1 cursor-pointer"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground mb-3",children:[e.jsx("span",{children:"Professional"}),e.jsx("span",{className:"text-purple-500 font-medium",children:"Tone"}),e.jsx("span",{children:"Fun/Casual"})]}),e.jsx(fe,{value:I,onValueChange:R,max:100,step:50,className:"py-1 cursor-pointer"})]})]})]}),o&&e.jsx("div",{className:"p-4 bg-red-500/10 border border-red-500/30 rounded-lg",children:e.jsx("p",{className:"text-sm text-red-500",children:o})}),c.length>0&&e.jsxs("div",{className:"p-4 bg-card rounded-lg border border-border",children:[e.jsxs("label",{className:"text-sm font-medium text-foreground mb-3 block",children:["Timeline Distribution",e.jsx("span",{className:"text-xs text-muted-foreground font-normal ml-2",children:"(drag handles to adjust)"})]}),e.jsxs("div",{className:"px-8",children:[e.jsx("div",{ref:K,className:D("flex h-14 rounded-lg overflow-hidden border border-border bg-muted/30 relative",v!==null&&"cursor-col-resize"),children:C.map((l,a)=>e.jsxs("div",{className:"relative h-full",style:{width:`${l.percentage}%`},children:[e.jsx($t,{children:e.jsxs(_t,{children:[e.jsx(At,{asChild:!0,children:e.jsxs("div",{className:D("h-full flex flex-col items-center justify-center text-foreground bg-background border-y border-l border-border/70 transition-colors duration-200 ease-out hover:bg-cyan-500/35",h===a&&"bg-cyan-500/35",a===C.length-1&&"border-r"),onClick:()=>x(a),children:[e.jsx("span",{className:"text-xs font-semibold",children:a+1}),e.jsx("span",{className:"text-[10px] text-muted-foreground",children:Te(l.sessionMinutes,$)})]})}),e.jsxs(Ot,{children:[e.jsx("p",{className:"font-medium",children:l.title||`Session ${a+1}`}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[Te(l.sessionMinutes,$)," ","(",l.percentage,"%)"]})]})]})}),a<C.length-1&&e.jsx("div",{className:D("absolute right-0 top-0 h-full w-3 cursor-col-resize z-10 flex items-center justify-center translate-x-1/2 group",v===a&&"bg-cyan-500/20"),onMouseDown:d=>{d.preventDefault(),d.stopPropagation(),L(a)},children:e.jsx("div",{className:D("w-1 h-8 rounded-full bg-border transition-colors","group-hover:bg-cyan-500 group-hover:w-1.5",v===a&&"bg-cyan-500 w-1.5")})})]},a))}),e.jsx("div",{className:"relative flex mt-1 pb-4",children:C.map((l,a)=>e.jsxs("div",{className:"relative text-[10px] text-muted-foreground",style:{width:`${l.percentage}%`},children:[e.jsx("span",{className:"absolute left-0 -translate-x-1/2",children:a===0&&q(l.isoStartDate)}),e.jsx("span",{className:"absolute right-0 translate-x-1/2",children:q(l.isoEndDate)})]},a))})]})]}),e.jsx("div",{className:"space-y-4",children:c.length===0?e.jsxs("div",{className:"text-center py-8 bg-muted/40 rounded-lg border border-border",children:[e.jsx(De,{className:"w-10 h-10 mx-auto text-muted-foreground mb-3"}),e.jsxs("p",{className:"text-muted-foreground mb-4",children:['Click "Generate ',A,' Sessions" above or add sessions manually']}),e.jsxs(z,{onClick:()=>r(),variant:"outline",className:"border-border",children:[e.jsx(he,{className:"w-4 h-4 mr-2"}),"Add Session"]})]}):C.map((l,a)=>e.jsxs("div",{onDragOver:d=>je(d,a),onDragLeave:ve,onDrop:d=>ne(d,a),onDragEnd:ue,className:D("bg-card rounded-lg border border-border overflow-hidden transition-all",se===a&&"opacity-50",G===a&&se!==a&&"border-cyan-500 border-2"),children:[e.jsxs("div",{draggable:!0,onDragStart:d=>Q(d,a),className:"w-full p-4 flex items-center justify-between hover:bg-muted/70 transition-colors cursor-grab active:cursor-grabbing",onClick:()=>x(h===a?null:a),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-muted-foreground hover:text-foreground transition-colors",children:e.jsx(Ft,{className:"w-5 h-5"})}),e.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-foreground font-semibold border border-border bg-background shrink-0",children:a+1}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-medium text-foreground",children:l.title||`Session ${a+1}`}),e.jsx("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:e.jsx("span",{children:l.topic||"No objective set"})})]})]}),e.jsxs("div",{className:"flex items-center gap-4 flex-nowrap",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-[210px] justify-end whitespace-nowrap",children:[e.jsx("span",{className:D("px-2.5 py-1 rounded-md text-xs font-semibold capitalize",l.difficulty==="easy"&&"bg-sky-500/10 text-sky-600",l.difficulty==="medium"&&"bg-violet-500/10 text-violet-600",l.difficulty==="hard"&&"bg-rose-500/10 text-rose-600"),children:l.difficulty}),e.jsx("span",{className:"text-sm text-muted-foreground",children:Te(l.sessionMinutes,$)})]}),e.jsx(z,{variant:"ghost",size:"icon",onClick:d=>{d.stopPropagation(),i(a)},className:"text-muted-foreground hover:text-red-500",disabled:c.length===1,children:e.jsx(Qe,{className:"w-4 h-4"})}),h===a?e.jsx(zt,{className:"w-5 h-5 text-muted-foreground"}):e.jsx(Ht,{className:"w-5 h-5 text-muted-foreground"})]})]}),h===a&&e.jsxs("div",{className:"p-4 border-t border-border space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-foreground mb-2 block",children:"Session Title"}),e.jsx(F,{value:l.title,onChange:d=>s(a,{title:d.target.value}),placeholder:`Session ${a+1}`,className:"bg-background border-border"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-foreground mb-2 block",children:"Objective"}),e.jsx(F,{value:l.topic,onChange:d=>s(a,{topic:d.target.value}),placeholder:"What will students learn?",className:"bg-background border-border"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-foreground mb-2 block",children:"Difficulty"}),e.jsx("div",{className:"flex gap-2",children:Rr.map(d=>e.jsxs("button",{onClick:()=>{s(a,{difficulty:d.value}),b(d.value)},className:D("flex-1 py-2 px-3 rounded-lg text-sm font-medium transition-all border",l.difficulty===d.value?`${d.bgColor} text-white border-transparent`:`bg-muted/50 ${d.textColor} ${d.borderColor} border-opacity-40 hover:border-opacity-100`),children:[d.label,e.jsxs("span",{className:"ml-2 text-xs opacity-80",children:["x",(Pe[d.value]/100).toFixed(1)]})]},d.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-foreground mb-2 block",children:"Session Guide"}),e.jsx(Ee,{value:l.guide,onChange:d=>s(a,{guide:d.target.value}),placeholder:"Provide instructions and guidance for this session",className:"bg-background border-border min-h-[100px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-foreground mb-2 block",children:"Deliverable Type"}),e.jsx("div",{className:"flex gap-3 w-full",children:Ir.map(d=>{const S=d.icon,k=l.deliverableType===d.value;return e.jsxs("button",{onClick:()=>s(a,{deliverableType:d.value,...d.value==="none"?{rubric:[]}:{}}),className:D("p-3 rounded-lg border flex flex-col items-center gap-2 transition-all flex-1",k?"border-cyan-500 bg-cyan-500/10 text-cyan-500":"border-border text-muted-foreground hover:border-border/70"),children:[e.jsx(S,{className:"w-5 h-5"}),e.jsx("span",{className:"text-xs",children:d.label})]},d.value)})})]}),l.deliverableType!=="none"&&(()=>{const d=l.rubric.reduce((k,B)=>k+B.weight,0),S=l.rubric.length===0||d===100;return e.jsxs("div",{className:"rounded-xl border border-border bg-muted/30 p-4 mt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("label",{className:"text-sm font-medium text-foreground",children:"Rubric Criteria"}),l.rubric.length>0&&e.jsxs("span",{className:D("text-xs font-medium px-2 py-0.5 rounded-full",S?"bg-emerald-500/10 text-emerald-500":"bg-red-500/10 text-red-500"),children:[d,"% / 100%"]})]}),e.jsxs("button",{onClick:()=>ye(a),className:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-medium border border-border/50 bg-background hover:bg-accent/50 transition-colors",children:[e.jsx(he,{className:"w-3.5 h-3.5"}),"Add Criterion"]})]}),l.rubric.length===0?e.jsxs("div",{className:"text-center py-8 rounded-lg border border-dashed border-border/50 bg-background/50",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"No rubric criteria defined"}),e.jsxs("button",{onClick:()=>ye(a),className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-medium border border-border/50 bg-background hover:bg-accent/50 transition-colors",children:[e.jsx(he,{className:"w-3.5 h-3.5"}),"Add First Criterion"]})]}):e.jsxs("div",{className:"space-y-2",children:[l.rubric.map((k,B)=>e.jsx("div",{className:"p-3 bg-background rounded-lg border border-border/50",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(F,{value:k.criterion,onChange:O=>X(a,B,{criterion:O.target.value}),placeholder:"Criterion name",className:"bg-background border-border/50 text-sm"}),e.jsx(F,{value:k.description,onChange:O=>X(a,B,{description:O.target.value}),placeholder:"Description",className:"bg-background border-border/50 text-sm"}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-muted-foreground mb-1 block",children:"Weight %"}),e.jsx(F,{type:"number",min:0,max:100,value:k.weight,onChange:O=>X(a,B,{weight:Math.min(100,Math.max(0,parseInt(O.target.value)||0))}),className:D("bg-background border-border/50 text-sm w-24",!S&&"border-red-500/50")})]})]}),e.jsx("button",{onClick:()=>Ne(a,B),className:"w-8 h-8 rounded-lg flex items-center justify-center text-muted-foreground hover:text-red-500 hover:bg-red-500/10 transition-colors",children:e.jsx(Qe,{className:"w-4 h-4"})})]})},k.id)),!S&&e.jsxs("p",{className:"text-xs text-red-500 mt-2",children:["Weights must add up to 100% (currently ",d,"%)"]})]})]})})()]})]},a))}),c.length>0&&e.jsx("div",{className:"flex gap-3",children:e.jsxs(z,{onClick:()=>{r(),x(c.length)},variant:"outline",className:"flex-1 border-border hover:border-border/70",children:[e.jsx(he,{className:"w-4 h-4 mr-2"}),"Add Session"]})}),N.sessions&&e.jsx("div",{className:"p-4 bg-red-500/10 border border-red-500/30 rounded-lg",children:e.jsx("p",{className:"text-sm text-red-500",children:N.sessions})}),e.jsx("div",{className:"p-4 bg-muted/40 rounded-lg border border-border",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Bt,{className:"w-4 h-4 text-cyan-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsxs("p",{className:"mb-2",children:[e.jsx("strong",{className:"text-foreground",children:"AI-Powered Sessions:"})," ","Based on your project title, background, and driving question, AI generates sessions with appropriate difficulty, time allocation, and rubric criteria."]}),e.jsxs("p",{children:[e.jsx("strong",{className:"text-foreground",children:"Difficulty = Time:"})," ","Easy sessions get less time, hard sessions get more. Adjust the weight slider for fine-tuning."]})]})]})})]})}function Ye(t){if(t<60)return`${t} minutes`;if(t<1440){const r=Math.floor(t/60),s=t%60;return s>0?`${r}h ${s}m`:`${r} hour${r>1?"s":""}`}else if(t<10080){const r=Math.floor(t/1440),s=Math.floor(t%1440/60);return s>0?`${r}d ${s}h`:`${r} day${r>1?"s":""}`}else{const r=Math.floor(t/10080),s=Math.floor(t%10080/1440);return s>0?`${r}w ${s}d`:`${r} week${r>1?"s":""}`}}function Fr(){const{wizardState:t,validateWizard:r,setWizardStep:s}=re(),{basicInfo:i,participantParams:n,timeline:m,sessions:u,isValid:c,validationErrors:f}=t;g.useEffect(()=>{r()},[i,n,m,u,r]);const y=c,N=U(m.startDate)&&U(m.endDate)?xe(new Date(m.endDate),new Date(m.startDate)):0,h=[{icon:be,title:"Project Information",targetStep:2,valid:!!i.title&&!!i.drivingQuestion,content:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Title: "}),e.jsx("span",{className:"text-foreground",children:i.title||e.jsx("span",{className:"text-red-500",children:"Not set"})})]}),i.background&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Background: "}),e.jsx("span",{className:"text-foreground line-clamp-2",children:i.background})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Driving Question: "}),e.jsx("span",{className:"text-foreground",children:i.drivingQuestion||e.jsx("span",{className:"text-red-500",children:"Not set"})})]})]})},{icon:Oe,title:"Team Formation",targetStep:3,valid:n.projectMode==="personal"||n.teamSize>=2,content:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Mode: "}),e.jsx("span",{className:"text-foreground capitalize",children:n.projectMode})]}),n.projectMode==="team"&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Team Size: "}),e.jsxs("span",{className:"text-foreground",children:[n.teamSize," members"]})]})]})},{icon:Se,title:"Timeline",targetStep:4,valid:!!m.startDate&&!!m.endDate,content:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Duration: "}),e.jsx("span",{className:"text-foreground",children:Ye(N)})]}),U(m.startDate)&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Start: "}),e.jsx("span",{className:"text-foreground",children:le(m.startDate,"MMM d, yyyy HH:mm")})]}),U(m.endDate)&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"End: "}),e.jsx("span",{className:"text-foreground",children:le(m.endDate,"MMM d, yyyy HH:mm")})]})]})},{icon:tt,title:"Sessions",targetStep:5,valid:u.length>0,content:e.jsx("div",{children:u.length===0?e.jsx("span",{className:"text-red-500",children:"No sessions defined"}):e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Total Sessions: "}),e.jsx("span",{className:"text-foreground",children:u.length})]}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:u.map((x,w)=>e.jsxs(Lt,{variant:"outline",className:"border-border text-xs",children:[x.title,x.durationMinutes>0&&e.jsxs("span",{className:"ml-1 text-muted-foreground",children:["(",Ye(x.durationMinutes),")"]})]},w))})]})})}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground mb-2",children:"Review & Deploy"}),e.jsx("p",{className:"text-muted-foreground",children:"Review your project configuration before creating it"})]}),e.jsxs("div",{className:D("p-4 rounded-lg border",y?"bg-green-500/10 border-green-500/30":"bg-red-500/10 border-red-500/30"),children:[e.jsx("div",{className:"flex items-center gap-3",children:y?e.jsxs(e.Fragment,{children:[e.jsx(We,{className:"w-5 h-5 text-green-500"}),e.jsx("span",{className:"text-green-500 font-medium",children:"Your project is ready to be created!"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ge,{className:"w-5 h-5 text-red-500"}),e.jsx("span",{className:"text-red-500 font-medium",children:"Please fix the following issues:"})]})}),!y&&Object.keys(f).length>0&&e.jsx("ul",{className:"mt-2 ml-8 list-disc text-sm text-red-500",children:Object.entries(f).map(([x,w])=>e.jsx("li",{children:w},x))})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:h.map((x,w)=>{const M=x.icon;return e.jsxs("button",{onClick:()=>s(x.targetStep),className:D("p-4 rounded-lg border text-left transition-all hover:ring-2 hover:ring-cyan-500/50 group cursor-pointer",x.valid?"bg-card border-border":"bg-red-500/5 border-red-500/30"),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(M,{className:D("w-4 h-4 transition-colors",x.valid?"text-cyan-500 group-hover:text-cyan-400":"text-red-500")}),e.jsx("h3",{className:"font-medium text-foreground group-hover:text-cyan-500 transition-colors",children:x.title}),x.valid?e.jsx(We,{className:"w-4 h-4 text-green-500 ml-auto"}):e.jsx(Ge,{className:"w-4 h-4 text-red-500 ml-auto"})]}),e.jsx("div",{className:"text-sm",children:x.content})]},w)})}),e.jsxs("div",{className:"p-4 bg-muted/40 rounded-lg border border-border",children:[e.jsx("h4",{className:"font-medium text-foreground mb-2",children:"What happens next?"}),e.jsx("ul",{className:"text-sm text-muted-foreground space-y-1 list-disc list-inside",children:e.jsx("li",{children:"A unique join code will be generated for explorers"})})]})]})}const we=[{id:1,label:"Mode",icon:Vt,description:"Choose creation mode"},{id:2,label:"Content",icon:be,description:"Project info & content"},{id:3,label:"Teams",icon:Oe,description:"Team formation"},{id:4,label:"Timeline",icon:Se,description:"Project duration"},{id:5,label:"Sessions",icon:tt,description:"Build sessions with AI"},{id:6,label:"Deploy",icon:rt,description:"Review & launch"}],Z=[{label:"5 min",value:5},{label:"15 min",value:15},{label:"30 min",value:30},{label:"1 hour",value:60},{label:"4 hours",value:240},{label:"8 hours",value:480},{label:"1 day",value:1440},{label:"2 days",value:2880},{label:"1 week",value:10080}],Je={easy:60,medium:100,hard:140};function zr(t){return t<=0?1:t<=60?3:t<=240?4:t<=480?5:t<=1440||t<=10080?3:t<=20160?5:t<=40320?6:(t<=80640,8)}const Hr=`You are an expert educational project designer.
Generate a complete PBL project structure based on a keyword and duration.
Generate exactly the number of sessions specified in the user prompt.
Each session must have a difficulty of "easy", "medium", or "hard" â€” vary difficulties to create a natural learning progression.
Rubric weights must be integer percentages between 0 and 100 (no decimals) and must sum to exactly 100.
IMPORTANT: Do NOT prefix or number session titles with labels like "Session 1:", "Session 2:", etc. Use descriptive, content-based titles only.
IMPORTANT: Do NOT use the word "student" or "students" anywhere in the output â€” not in titles, topics, guides, background, driving question, rubric criteria, or rubric descriptions. Use "learner", "participant", "team", or rephrase to avoid addressing anyone directly.`,Br={type:"object",properties:{title:{type:"string",description:"Engaging project title"},background:{type:"string",description:"Context about the project (2-3 sentences)"},drivingQuestion:{type:"string",description:"The central open-ended question"},sessions:{type:"array",items:{type:"object",properties:{title:{type:"string"},topic:{type:"string"},difficulty:{type:"string",enum:["easy","medium","hard"]},guide:{type:"string"},deliverableType:{type:"string",enum:["none","document"]},rubric:{type:"array",items:{type:"object",properties:{criterion:{type:"string"},description:{type:"string"},weight:{type:"integer",minimum:0,maximum:100}},required:["criterion","description","weight"],additionalProperties:!1}}},required:["title","topic","difficulty","guide","deliverableType","rubric"],additionalProperties:!1}}},required:["title","background","drivingQuestion","sessions"],additionalProperties:!1};function Lr(){const t=Ze(),{currentUser:r}=Fe(),[s,i]=g.useState(!1),[n,m]=g.useState(!1),[u,c]=g.useState(!1),[f,y]=g.useState(""),[N,h]=g.useState(0),{wizardState:x,setWizardStep:w,nextStep:M,prevStep:o,resetWizard:p,setTimeline:j,setLastSessionDifficulty:P,createProject:I,quickStart:R}=re(),{currentStep:v,totalSteps:L}=x,K=v===3&&x.participantParams.projectMode==="personal",W=!s&&(()=>{const b=v;if(b===2)return!!x.basicInfo.title.trim()&&!!x.basicInfo.drivingQuestion.trim();if(b===3)return x.participantParams.projectMode==="personal"||x.participantParams.teamSize>=2;if(b===4)return!!x.timeline.startDate&&!!x.timeline.endDate;if(b===5){if(x.sessions.length===0)return!1;for(const _ of x.sessions)if(_.deliverableType!=="none"&&_.rubric.length>0&&_.rubric.reduce((E,H)=>E+H.weight,0)!==100)return!1}return b===L?x.isValid:!0})();g.useEffect(()=>{p();const b=new Date(Date.now()+600*1e3).toISOString();j({startDate:b,endDate:""})},[]),g.useEffect(()=>{r?.defaultSessionDifficulty&&P(r.defaultSessionDifficulty)},[r,P]);const G=()=>{v===1?t({to:"/creator"}):o()},T=async()=>{if(v===L){if(!r?.id){te.error("You must be logged in to create a project");return}i(!0);try{await I(r.id)?(te.success("Project created successfully!"),t({to:"/creator"})):te.error("Please fix validation errors before continuing")}finally{i(!1)}}else if(v===1&&x.mode==="quickstart")c(!0);else{const b=M();!b.success&&b.error&&te.error(b.error)}},$=async()=>{if(!f.trim()){te.error("Please enter a keyword");return}m(!0);try{const b=Z[N],_=zr(b.value);let C;try{C=await ze()}catch(l){console.error("Error getting AI model, using default:",l),C="openrouter/auto"}const E=await Ae({data:{model:C,messages:[{role:"system",content:Hr},{role:"user",content:`Generate a project for keyword: "${f}" with total duration: ${b.label}. Generate exactly ${_} sessions.`}],max_tokens:3e3,temperature:.7,response_format:{type:"json_schema",json_schema:{name:"quick_start_response",strict:!0,schema:Br}}}});if(!E.success)throw new Error(E.error||"API request failed");let Q=E.content.trim();const je=Q.match(/```(?:json)?\s*([\s\S]*?)```/);je&&(Q=je[1].trim());const ve=Q.match(/\{[\s\S]*\}/);ve&&(Q=ve[0]);const ne=JSON.parse(Q),ue=new Date;ue.setMinutes(Math.ceil(ue.getMinutes()/15)*15,0,0);const me=ue,ye=new Date(me.getTime()+b.value*60*1e3),X=ne.sessions.map((l,a)=>{const d=["easy","medium","hard"].includes(l.difficulty)?l.difficulty:"medium";return{...l,index:a,difficulty:d,weight:Je[d]||100,durationMinutes:Je[d]||100,startDate:"",endDate:"",rubric:l.rubric.map((S,k)=>({id:`quick_r_${a}_${k}`,...S})),resources:[],templates:[],llmModel:"gpt-4"}}),Ne=X.reduce((l,a)=>l+a.weight,0),ae=b.value;let q=new Date(me.getTime());for(const l of X){const a=Ne>0?l.weight/Ne:1/X.length,d=Math.max(1,Math.round(ae*a));l.durationMinutes=d,l.startDate=q.toISOString(),q=new Date(q.getTime()+d*60*1e3),l.endDate=q.toISOString()}R({basicInfo:{title:ne.title,background:ne.background,drivingQuestion:ne.drivingQuestion},sessions:X,timeline:{startDate:me.toISOString(),endDate:ye.toISOString()}}),te.success("Project generated successfully!"),c(!1),w(6)}catch(b){console.error("Quick Start generation error:",b),te.error("Failed to generate project. Please try again.")}finally{m(!1)}},A=b=>{b===1&&v>1||w(b)},J=()=>{switch(v){case 1:return e.jsx(Sr,{});case 2:return e.jsx(Mr,{});case 3:return e.jsx(Pr,{});case 4:return e.jsx(Er,{});case 5:return e.jsx(Or,{});case 6:return e.jsx(Fr,{});default:return null}};return e.jsxs("div",{className:"container max-w-7xl mx-auto py-8 px-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-8 gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-foreground flex items-center gap-3",children:[e.jsx(Ut,{className:"w-8 h-8 text-cyan-500"}),"Create New Project"]}),e.jsxs("p",{className:"text-muted-foreground mt-1",children:["Step ",v," of ",L,":"," ",we[v-1]?.description]})]}),e.jsxs(z,{variant:"outline",onClick:()=>t({to:"/creator"}),className:"text-muted-foreground hover:text-foreground border-border",children:[e.jsx(Ke,{className:"w-4 h-4 mr-2"}),"Back to Dashboard"]})]}),e.jsx("div",{className:"hidden lg:flex items-center w-full mb-12 py-2 relative",children:we.map((b,_)=>{const C=b.icon,E=v>b.id,H=v===b.id,Q=b.id===1?v===1:!0;return e.jsxs("div",{className:"flex-1 flex flex-col items-center relative",children:[_<we.length-1&&e.jsx("div",{className:D("absolute top-5 left-[50%] right-[-50%] h-0.5 z-0 transition-colors",E?"bg-green-600":"bg-muted")}),e.jsxs("button",{onClick:()=>A(b.id),className:D("flex flex-col items-center gap-2 transition-all z-10 relative",Q&&!H&&"cursor-pointer hover:opacity-80",!Q&&"cursor-default"),children:[e.jsx("div",{className:D("w-10 h-10 rounded-full flex items-center justify-center transition-all shadow-sm z-20 relative",E&&"bg-green-600 text-white",H&&"bg-cyan-600 text-white border-4 border-background ring-2 ring-cyan-500",!E&&!H&&"bg-background text-muted-foreground border-2 border-muted"),children:E?e.jsx(Qt,{className:"w-5 h-5"}):e.jsx(C,{className:"w-5 h-5"})}),e.jsx("div",{className:"flex flex-col items-center min-h-[20px]",children:e.jsx("span",{className:D("text-[10px] font-bold uppercase tracking-tight",H?"text-cyan-500":E?"text-green-600":"text-muted-foreground"),children:b.label})})]})]},b.id)})}),e.jsx("div",{className:"lg:hidden flex items-center justify-center gap-2 mb-8",children:we.map(b=>e.jsx("div",{className:D("w-2 h-2 rounded-full transition-all",v===b.id&&"w-6 bg-cyan-500",v>b.id&&"bg-green-500",v<b.id&&"bg-border")},b.id))}),e.jsx("div",{className:D("bg-card border border-border rounded-xl p-6",K?"min-h-[260px]":"min-h-[400px]"),children:J()}),e.jsxs("div",{className:"flex justify-between mt-6",children:[e.jsxs(z,{variant:"outline",onClick:G,className:"border-border",children:[e.jsx(Ke,{className:"w-4 h-4 mr-2"}),v===1?"Cancel":"Back"]}),e.jsx(z,{onClick:T,disabled:!W,className:D(v===L?"bg-green-600 hover:bg-green-700 text-white":"bg-cyan-600 hover:bg-cyan-700 text-white",!W&&"opacity-60"),children:v===L?s?e.jsxs(e.Fragment,{children:[e.jsx(ge,{className:"w-4 h-4 mr-2 animate-spin"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(rt,{className:"w-4 h-4 mr-2"}),"Create Project"]}):e.jsxs(e.Fragment,{children:["Next",e.jsx(Zt,{className:"w-4 h-4 ml-2"})]})})]}),e.jsx(Kt,{open:u,onOpenChange:c,children:e.jsxs(Wt,{className:"sm:max-w-[425px]",overlayClassName:"backdrop-blur-sm",children:[e.jsxs(Gt,{children:[e.jsxs(qt,{className:"flex items-center gap-2",children:[e.jsx(et,{className:"w-5 h-5 text-purple-500"}),"Quick Start Configuration"]}),e.jsx(Yt,{children:"Provide a keyword and duration to instantly set up your project."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(ie,{htmlFor:"keyword",children:"Keyword"}),e.jsx(F,{id:"keyword",placeholder:"e.g. Climate Change, Blockchain, Cooking",value:f,onChange:b=>y(b.target.value),autoFocus:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(ie,{htmlFor:"duration",children:"Duration"}),e.jsx("span",{className:"text-sm font-medium text-purple-600",children:Z[N].label})]}),e.jsx("div",{className:"py-4",children:e.jsx(fe,{id:"duration",min:0,max:Z.length-1,step:1,value:[N],onValueChange:b=>h(b[0]),className:"cursor-pointer"})}),e.jsxs("div",{className:"flex justify-between text-[10px] text-muted-foreground",children:[e.jsx("span",{children:Z[0].label}),e.jsx("span",{children:Z[Math.floor(Z.length/2)].label}),e.jsx("span",{children:Z[Z.length-1].label})]})]})]}),e.jsxs(Jt,{children:[e.jsx(z,{variant:"outline",onClick:()=>c(!1),disabled:n,children:"Cancel"}),e.jsx(z,{onClick:$,disabled:n,className:"bg-gradient-to-r from-purple-600 to-cyan-600 hover:from-purple-700 hover:to-cyan-700 text-white min-w-[120px]",children:n?e.jsxs(e.Fragment,{children:[e.jsx(ge,{className:"w-4 h-4 mr-2 animate-spin"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(De,{className:"w-4 h-4 mr-2"}),"Generate"]})})]})]})})]})}function ts(){const t=Ze(),{isAuthenticated:r,currentUser:s}=Fe();return g.useEffect(()=>{r||t({to:"/"})},[r,t]),g.useEffect(()=>{s&&!s.role.includes("creator")&&t({to:"/explorer"})},[s,t]),!s||!s.role.includes("creator")?null:e.jsx("div",{className:"min-h-[calc(100vh-4rem)] bg-background",children:e.jsx(Lr,{})})}export{ts as component};
